<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Function to update a planned multi-arm multi-stage design to account for unplanned adaptations."><title>Update the stopping boundaries of multi-arm multi-stage study at an interim analysis, allowing for unplanned treatment selection and/or sample-size reassessment. — stepdown.update • MAMS</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Update the stopping boundaries of multi-arm multi-stage study at an interim analysis, allowing for unplanned treatment selection and/or sample-size reassessment. — stepdown.update"><meta property="og:description" content="Function to update a planned multi-arm multi-stage design to account for unplanned adaptations."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MAMS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tutorials">Tutorials</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tutorials">
    <h6 class="dropdown-header" data-toc-skip>Basics</h6>
    <a class="dropdown-item" href="../articles/web_only/reproducibility.html">Reproducibility</a>
    <a class="dropdown-item" href="../articles/web_only/parallelisation.html">Parallelisation</a>
    <h6 class="dropdown-header" data-toc-skip>Design studies</h6>
    <a class="dropdown-item" href="../articles/web_only/single-stage_design.html">Single stage design</a>
    <a class="dropdown-item" href="../articles/web_only/multi-stage_design.html">Multi-stage design</a>
    <a class="dropdown-item" href="../articles/web_only/evaluating_properties.html">Desing operating charachteristics</a>
    <a class="dropdown-item" href="../articles/web_only/step-down_design.html">A step-down design</a>
    <a class="dropdown-item" href="../articles/web_only/unforeseen_design_modifications.html">Unforeseen design modifications</a>
    <a class="dropdown-item" href="../articles/web_only/non-normal_endpoints.html">Non-normal endpoints</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Update the stopping boundaries of multi-arm multi-stage study at an interim analysis, allowing for unplanned treatment selection and/or sample-size reassessment.</h1>
      
      <div class="d-none name"><code>stepdown.update.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function to update a planned multi-arm multi-stage design to account for unplanned adaptations.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">stepdown.update</span><span class="op">(</span>current.mams<span class="op">=</span><span class="fu"><a href="stepdown.mams.html">stepdown.mams</a></span><span class="op">(</span><span class="op">)</span>, nobs<span class="op">=</span><span class="cn">NULL</span>, </span>
<span>                zscores<span class="op">=</span><span class="cn">NULL</span>, selected.trts<span class="op">=</span><span class="cn">NULL</span>, nfuture<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>current.mams</dt>
<dd><p>The planned step-down MAMS design prior to the current interim analysis (=<code>defaultstepdown.mams()</code>).</p></dd>

  <dt>nobs</dt>
<dd><p>Cumulative sample sizes observed on each treatment arm up to and including the current interim analysis.</p></dd>

  <dt>zscores</dt>
<dd><p>Observed vector of test statistics at the current interim analysis.</p></dd>

  <dt>selected.trts</dt>
<dd><p>The set of experimental treatments to be taken forward to the next stage of testing. This argument should be omitted at the final analysis.</p></dd>

  <dt>nfuture</dt>
<dd><p>A matrix of future cumulative sample sizes. The number of rows must be equal to the originally planned number of stages (2 or 3) minus the number of stages already observed. The number of columns must be equal to the number of treatment arms (default=<code>NULL</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function implements the ideas described in Magirr et al. (2014) to update a design according to unplanned design modifications. It takes as input the planned multi-arm multi-stage design prior to the interim analysis, together with the actually observed cumulative sample sizes and test statistics. Treatments to be included in future stages, as well as future sample sizes, can be chosen without following pre-specified rules. The output is a new multi-arm multi-stage design for the remaining stages such that the familywise error remains controlled at the pre-specified level.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of the class MAMS.stepdown containing the following components: <br></p>
<dl><dt>l</dt>
<dd><p>Lower boundaries.</p></dd>
 
  <dt>u</dt>
<dd><p>Upper boundaries.</p></dd>

  <dt>sample.sizes</dt>
<dd><p>Cumulative sample sizes on each treatment arm.</p></dd>

  <dt>K</dt>
<dd><p>Number of experimental treatments.</p></dd>

  <dt>J</dt>
<dd><p>Number of stages in the trial.</p></dd>

  <dt>alpha.star</dt>
<dd><p>Cumulative familywise error rate spent at each analysis, conditional on results so far.</p></dd>

  <dt>selection</dt>
<dd><p>Pre-specified method of treatment selection.</p></dd>

  <dt>zscores</dt>
<dd><p>A list containing the observed test statistics at analyses so far (at the design stage this is NULL).</p></dd>

  <dt>selected.trts</dt>
<dd><p>A list containing the treatments selected for each stage.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="generic.html">print.MAMS.stepdown</a></code>, <code><a href="generic.html">summary.MAMS.stepdown</a></code>, <code><a href="generic.html">plot.MAMS.stepdown</a></code>, <code><a href="stepdown.mams.html">stepdown.mams</a></code>, <code><a href="MAMS-package.html">MAMS</a></code>.</p></div>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Jaki T., Pallmann P. and Magirr D. (2019), <em>The R Package MAMS for Designing Multi-Arm Multi-Stage Clinical Trials</em>, <b>Journal of Statistical Software</b>, 88(4), 1-25. Link: <a href="https://doi.org/10.18637/jss.v088.i04" class="external-link">doi:10.18637/jss.v088.i04</a></p>
<p>Magirr D., Jaki T. and Whitehead J. (2012), <em>A generalized Dunnett test for multi-arm multi-stage clinical studies with treatment selection</em>, <b>Biometrika</b>, 99(2), 494-501. Link: <a href="https://doi.org/10.1093/biomet/ass002" class="external-link">doi:10.1093/biomet/ass002</a></p>
<p>Magirr D., Stallard N. and Jaki T. (2014), <em>Flexible sequential designs for multi-arm clinical trials</em>, <b>Statistics in Medicine</b>, 33(19), 3269-3279. Link: <a href="https://doi.org/10.1002/sim.6183" class="external-link">doi:10.1002/sim.6183</a></p>
<p>Stallard N. and Todd S. (2003), <em>Sequential designs for phase III clinical trials incorporating treatment selection</em>, <b>Statistics in Medicine</b>, 22(5), 689-703.<br></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Dominic Magirr</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># 2-stage 3-treatments versus control design</span></span></span>
<span class="r-in"><span><span class="co"># all promising treatments are selected:</span></span></span>
<span class="r-in"><span><span class="va">orig_mams</span> <span class="op">&lt;-</span> <span class="fu"><a href="stepdown.mams.html">stepdown.mams</a></span><span class="op">(</span>nMat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">2</span>, ncol<span class="op">=</span><span class="fl">4</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                           alpha.star<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.05</span><span class="op">)</span>, lb<span class="op">=</span><span class="fl">0</span>, </span></span>
<span class="r-in"><span>                           selection<span class="op">=</span><span class="st">"all.promising"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># make adjustment for the observed sample sizes </span></span></span>
<span class="r-in"><span><span class="co"># not being exactly as planned:</span></span></span>
<span class="r-in"><span><span class="fu">stepdown.update</span><span class="op">(</span><span class="va">orig_mams</span>, nobs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">8</span>, <span class="fl">13</span>, <span class="fl">11</span><span class="op">)</span>, zscores<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.1</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.2</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                selected.trts<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, nfuture<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design parameters for a 2 stage trial with 3 treatments</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                   Stage 1 Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size  (control):                      9      20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (treatment  1 ):       8      20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (treatment  2 ):      13      20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (treatment  3 ):      11      20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum total sample size:  80 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intersection hypothesis H_{ 1 }: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Stage 1    Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional error    0.00 0.09721452</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper boundary       2.33 1.67000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower boundary       0.00 1.67000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intersection hypothesis H_{ 2 }: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Stage 1 Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional error    0.00       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper boundary       2.33     Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower boundary       0.00     Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intersection hypothesis H_{ 1 2 }: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Stage 1    Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional error    0.00 0.04784817</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper boundary       2.56 1.95000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower boundary       0.00 1.95000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intersection hypothesis H_{ 3 }: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Stage 1    Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional error    0.00 0.01530737</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper boundary       2.33 1.67000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower boundary       0.00 1.67000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intersection hypothesis H_{ 1 3 }: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Stage 1   Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional error    0.00 0.0509194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper boundary       2.56 1.9500000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower boundary       0.00 1.9500000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intersection hypothesis H_{ 2 3 }: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Stage 1     Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional error    0.00 0.005386518</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper boundary       2.55 1.950000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower boundary       0.00 1.950000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intersection hypothesis H_{ 1 2 3 }: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Stage 1    Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional error    0.00 0.03294475</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper boundary       2.68 2.10000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower boundary       0.00 2.10000000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># make adjustment for the observed sample sizes </span></span></span>
<span class="r-in"><span><span class="co"># not being exactly as planned. In addition, drop treatment 2:</span></span></span>
<span class="r-in"><span><span class="fu">stepdown.update</span><span class="op">(</span><span class="va">orig_mams</span>, nobs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">8</span>, <span class="fl">13</span>, <span class="fl">11</span><span class="op">)</span>, zscores<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.1</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.2</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                selected.trts<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, nfuture<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design parameters for a 2 stage trial with 3 treatments</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                   Stage 1 Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size  (control):                      9      20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (treatment  1 ):       8      20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (treatment  2 ):      13      20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (treatment  3 ):      11      20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum total sample size:  80 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intersection hypothesis H_{ 1 }: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Stage 1    Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional error    0.00 0.09721452</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper boundary       2.33 1.67000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower boundary       0.00 1.67000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intersection hypothesis H_{ 2 }: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Stage 1 Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional error    0.00       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper boundary       2.33     Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower boundary       0.00     Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intersection hypothesis H_{ 1 2 }: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Stage 1    Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional error    0.00 0.04784817</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper boundary       2.56 1.95000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower boundary       0.00 1.95000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intersection hypothesis H_{ 3 }: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Stage 1    Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional error    0.00 0.01530737</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper boundary       2.33 1.67000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower boundary       0.00 1.67000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intersection hypothesis H_{ 1 3 }: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Stage 1   Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional error    0.00 0.0509194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper boundary       2.56 1.9500000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower boundary       0.00 1.9500000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intersection hypothesis H_{ 2 3 }: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Stage 1     Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional error    0.00 0.005386518</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper boundary       2.55 1.940000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower boundary       0.00 1.940000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intersection hypothesis H_{ 1 2 3 }: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Stage 1   Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional error    0.00 0.0329459</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper boundary       2.68 2.1000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower boundary       0.00 2.1000000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># make adjustment for the observed sample sizes not being </span></span></span>
<span class="r-in"><span><span class="co"># exactly as planned. In addition, drop treatment 2. In addition, </span></span></span>
<span class="r-in"><span><span class="co"># double the planed cumulative second stage sample sizes:</span></span></span>
<span class="r-in"><span><span class="va">updated_mams</span> <span class="op">&lt;-</span> <span class="fu">stepdown.update</span><span class="op">(</span><span class="va">orig_mams</span>, nobs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">8</span>, <span class="fl">13</span>, <span class="fl">11</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                                 zscores<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.1</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.2</span><span class="op">)</span>, selected.trts<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                                 nfuture<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">40</span>, <span class="fl">13</span>, <span class="fl">40</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">1</span>, ncol<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Account for the observed second stage sample sizes:</span></span></span>
<span class="r-in"><span><span class="fu">stepdown.update</span><span class="op">(</span><span class="va">updated_mams</span>, nobs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">38</span>, <span class="fl">41</span>, <span class="fl">13</span>, <span class="fl">36</span><span class="op">)</span>, zscores<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.9</span>, <span class="op">-</span><span class="cn">Inf</span>, <span class="fl">1.2</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                selected.trts<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design parameters for a 2 stage trial with 3 treatments</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                   Stage 1 Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size  (control):                      9      38</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (treatment  1 ):       8      41</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (treatment  2 ):      13      13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (treatment  3 ):      11      36</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum total sample size:  128 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intersection hypothesis H_{ 1 }: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Stage 1    Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional error    0.00 0.09721452</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper boundary       2.33 1.64000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower boundary       0.00 1.64000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intersection hypothesis H_{ 2 }: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Stage 1 Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional error    0.00       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper boundary       2.33     Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower boundary       0.00     Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intersection hypothesis H_{ 1 2 }: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Stage 1    Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional error    0.00 0.04784817</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper boundary       2.56 1.96000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower boundary       0.00 1.96000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intersection hypothesis H_{ 3 }: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Stage 1    Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional error    0.00 0.01530737</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper boundary       2.33 1.97000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower boundary       0.00 1.97000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intersection hypothesis H_{ 1 3 }: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Stage 1   Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional error    0.00 0.0509194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper boundary       2.56 2.0200000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower boundary       0.00 2.0200000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intersection hypothesis H_{ 2 3 }: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Stage 1     Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional error    0.00 0.005386518</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper boundary       2.55 2.310000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower boundary       0.00 2.310000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intersection hypothesis H_{ 1 2 3 }: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Stage 1   Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional error    0.00 0.0329481</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper boundary       2.68 2.1900000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower boundary       0.00 2.1900000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 'select.best' design. Account for actually observed sample sizes </span></span></span>
<span class="r-in"><span><span class="co"># in first stage, and drop treatment 2:</span></span></span>
<span class="r-in"><span><span class="va">orig_mams</span> <span class="op">&lt;-</span> <span class="fu"><a href="stepdown.mams.html">stepdown.mams</a></span><span class="op">(</span>nMat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">2</span>, ncol<span class="op">=</span><span class="fl">4</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                           alpha.star<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.05</span><span class="op">)</span>, lb<span class="op">=</span><span class="fl">0</span>, selection<span class="op">=</span><span class="st">"select.best"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">stepdown.update</span><span class="op">(</span><span class="va">orig_mams</span>, nobs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">8</span>, <span class="fl">13</span>, <span class="fl">11</span><span class="op">)</span>, zscores<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.1</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.2</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                selected.trts<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, nfuture<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design parameters for a 2 stage trial with 3 treatments</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                   Stage 1 Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size  (control):                      9      20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (treatment  1 ):       8      20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (treatment  2 ):      13      20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (treatment  3 ):      11      20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum total sample size:  80 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intersection hypothesis H_{ 1 }: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Stage 1    Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional error    0.00 0.09721452</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper boundary       2.33 1.67000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower boundary       0.00 1.67000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intersection hypothesis H_{ 2 }: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Stage 1 Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional error    0.00       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper boundary       2.33     Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower boundary       0.00     Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intersection hypothesis H_{ 1 2 }: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Stage 1    Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional error    0.00 0.05471703</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper boundary       2.56 1.90000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower boundary       0.00 1.90000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intersection hypothesis H_{ 3 }: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Stage 1    Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional error    0.00 0.01530737</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper boundary       2.33 1.67000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower boundary       0.00 1.67000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intersection hypothesis H_{ 1 3 }: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Stage 1    Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional error    0.00 0.05471703</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper boundary       2.56 1.92000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower boundary       0.00 1.92000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intersection hypothesis H_{ 2 3 }: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Stage 1     Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional error    0.00 0.006198615</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper boundary       2.55 1.910000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower boundary       0.00 1.910000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intersection hypothesis H_{ 1 2 3 }: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Stage 1   Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional error    0.00 0.0381898</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper boundary       2.68 2.0500000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower boundary       0.00 2.0500000</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Thomas Jaki, Dominique-Laurent Couturier, Dominic Magirr, Nikita Mozgunov, Philip Pallmann.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

