<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Update the stopping boundaries of multi-arm multi-stage study at an interim analysis, allowing for unplanned treatment selection and/or sample-size reassessment. — stepdown.update • MAMS</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Update the stopping boundaries of multi-arm multi-stage study at an interim analysis, allowing for unplanned treatment selection and/or sample-size reassessment. — stepdown.update"><meta name="description" content="Function to update a planned multi-arm multi-stage design to
account for unplanned adaptations."><meta property="og:description" content="Function to update a planned multi-arm multi-stage design to
account for unplanned adaptations."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MAMS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><h6 class="dropdown-header" data-toc-skip>Basics</h6></li>
    <li><a class="dropdown-item" href="../articles/web_only/reproducibility.html">Reproducibility</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/parallelisation.html">Parallelisation</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Design studies</h6></li>
    <li><a class="dropdown-item" href="../articles/web_only/single-stage_design.html">Single stage design</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/multi-stage_design.html">Multi-stage design</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/evaluating_properties.html">Design operating characteristics</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/step-down_design.html">A step-down design</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/unforeseen_design_modifications.html">Unforeseen design modifications</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/non-normal_endpoints.html">Non-normal endpoints</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Update the stopping boundaries of multi-arm multi-stage study at an interim analysis, allowing for unplanned treatment selection and/or sample-size reassessment.</h1>

      <div class="d-none name"><code>stepdown.update.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function to update a planned multi-arm multi-stage design to
account for unplanned adaptations.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">stepdown.update</span><span class="op">(</span></span>
<span>  current.mams <span class="op">=</span> <span class="fu"><a href="stepdown.mams.html">stepdown.mams</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  nobs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  zscores <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  selected.trts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nfuture <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-current-mams">current.mams<a class="anchor" aria-label="anchor" href="#arg-current-mams"></a></dt>
<dd><p>The planned step-down MAMS design prior to the current
interim analysis (=defaultstepdown.mams()).</p></dd>


<dt id="arg-nobs">nobs<a class="anchor" aria-label="anchor" href="#arg-nobs"></a></dt>
<dd><p>Cumulative sample sizes observed on each treatment arm up to and
including the current interim analysis.</p></dd>


<dt id="arg-zscores">zscores<a class="anchor" aria-label="anchor" href="#arg-zscores"></a></dt>
<dd><p>Observed vector of test statistics at the current interim
analysis.</p></dd>


<dt id="arg-selected-trts">selected.trts<a class="anchor" aria-label="anchor" href="#arg-selected-trts"></a></dt>
<dd><p>The set of experimental treatments to be taken forward
to the next stage of testing. This argument should be omitted at the final
analysis.</p></dd>


<dt id="arg-nfuture">nfuture<a class="anchor" aria-label="anchor" href="#arg-nfuture"></a></dt>
<dd><p>A matrix of future cumulative sample sizes. The number of rows
must be equal to the originally planned number of stages (2 or 3) minus the
number of stages already observed. The number of columns must be equal to
the number of treatment arms (default=NULL).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function implements the ideas described in Magirr et al. (2014)
to update a design according to unplanned design modifications. It takes as
input the planned multi-arm multi-stage design prior to the interim analysis,
together with the actually observed cumulative sample sizes and test
statistics. Treatments to be included in future stages, as well as future
sample sizes, can be chosen without following pre-specified rules. The output
is a new multi-arm multi-stage design for the remaining stages such that the
familywise error remains controlled at the pre-specified level.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Jaki T., Pallmann P. and Magirr D. (2019), The R Package MAMS for Designing
Multi-Arm Multi-Stage Clinical Trials, Journal of Statistical Software,
88(4), 1-25. Link: doi:10.18637/jss.v088.i04</p>
<p>Magirr D., Jaki T. and Whitehead J. (2012), A generalized Dunnett test for
multi-arm multi-stage clinical studies with treatment selection, Biometrika,
99(2), 494-501. Link: doi:10.1093/biomet/ass002</p>
<p>Magirr D., Stallard N. and Jaki T. (2014), Flexible sequential designs for
multi-arm clinical trials, Statistics in Medicine, 33(19), 3269-3279.
Link: doi:10.1002/sim.6183</p>
<p>Stallard N. and Todd S. (2003), Sequential designs for phase III clinical
trials incorporating treatment selection, Statistics in Medicine,
22(5), 689-703.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Dominic Magirr</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># 2-stage 3-treatments versus control design</span></span></span>
<span class="r-in"><span><span class="co"># all promising treatments are selected:</span></span></span>
<span class="r-in"><span><span class="va">orig_mams</span> <span class="op">&lt;-</span> <span class="fu"><a href="stepdown.mams.html">stepdown.mams</a></span><span class="op">(</span>nMat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">2</span>, ncol<span class="op">=</span><span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                           alpha.star<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.05</span><span class="op">)</span>, lb<span class="op">=</span><span class="fl">0</span>,</span></span>
<span class="r-in"><span>                           selection<span class="op">=</span><span class="st">"all.promising"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># make adjustment for the observed sample sizes</span></span></span>
<span class="r-in"><span><span class="co"># not being exactly as planned:</span></span></span>
<span class="r-in"><span><span class="fu">stepdown.update</span><span class="op">(</span><span class="va">orig_mams</span>, nobs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">8</span>, <span class="fl">13</span>, <span class="fl">11</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 zscores<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.1</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 selected.trts<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, nfuture<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># make adjustment for the observed sample sizes</span></span></span>
<span class="r-in"><span><span class="co"># not being exactly as planned. In addition, drop treatment 2:</span></span></span>
<span class="r-in"><span><span class="fu">stepdown.update</span><span class="op">(</span><span class="va">orig_mams</span>, nobs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">8</span>, <span class="fl">13</span>, <span class="fl">11</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 zscores<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.1</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 selected.trts<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, nfuture<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># make adjustment for the observed sample sizes not being</span></span></span>
<span class="r-in"><span><span class="co"># exactly as planned. In addition, drop treatment 2. In addition,</span></span></span>
<span class="r-in"><span><span class="co"># double the planed cumulative second stage sample sizes:</span></span></span>
<span class="r-in"><span><span class="va">updated_mams</span> <span class="op">&lt;-</span> <span class="fu">stepdown.update</span><span class="op">(</span><span class="va">orig_mams</span>, nobs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">8</span>, <span class="fl">13</span>, <span class="fl">11</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                 zscores<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.1</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                 selected.trts<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                 nfuture<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">40</span>, <span class="fl">13</span>, <span class="fl">40</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                 nrow<span class="op">=</span><span class="fl">1</span>, ncol<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Account for the observed second stage sample sizes:</span></span></span>
<span class="r-in"><span><span class="fu">stepdown.update</span><span class="op">(</span><span class="va">updated_mams</span>, nobs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">38</span>, <span class="fl">41</span>, <span class="fl">13</span>, <span class="fl">36</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                zscores<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.9</span>, <span class="op">-</span><span class="cn">Inf</span>, <span class="fl">1.2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                selected.trts<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 'select.best' design. Account for actually observed sample sizes</span></span></span>
<span class="r-in"><span><span class="co"># in first stage, and drop treatment 2:</span></span></span>
<span class="r-in"><span><span class="va">orig_mams</span> <span class="op">&lt;-</span> <span class="fu"><a href="stepdown.mams.html">stepdown.mams</a></span><span class="op">(</span>nMat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">2</span>, ncol<span class="op">=</span><span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                           alpha.star<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.05</span><span class="op">)</span>, lb<span class="op">=</span><span class="fl">0</span>,</span></span>
<span class="r-in"><span>                           selection<span class="op">=</span><span class="st">"select.best"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">stepdown.update</span><span class="op">(</span><span class="va">orig_mams</span>, nobs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">8</span>, <span class="fl">13</span>, <span class="fl">11</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 zscores<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.1</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 selected.trts<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, nfuture<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Jaki, Dominique-Laurent Couturier, Dominic Magirr, Nikita Mozgunov, Philip Pallmann.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>



  <script data-goatcounter="https://nikotinz.goatcounter.com/count" data-goatcounter-settings='{"allow_local": true}' async src="https://gc.zgo.at/count.js"></script></body></html>

