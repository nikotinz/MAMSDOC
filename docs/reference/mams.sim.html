<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simulating multi-arm multi-stage designs — mams.sim • MAMS</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulating multi-arm multi-stage designs — mams.sim"><meta name="description" content="The function simulates multi-arm multi-stage designs and estimates power and
expected sample size."><meta property="og:description" content="The function simulates multi-arm multi-stage designs and estimates power and
expected sample size."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MAMS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><h6 class="dropdown-header" data-toc-skip>Basics</h6></li>
    <li><a class="dropdown-item" href="../articles/web_only/reproducibility.html">Reproducibility</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/parallelisation.html">Parallelisation</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Design studies</h6></li>
    <li><a class="dropdown-item" href="../articles/web_only/single-stage_design.html">Single stage design</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/multi-stage_design.html">Multi-stage design</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/evaluating_properties.html">Design operating characteristics</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/step-down_design.html">A step-down design</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/unforeseen_design_modifications.html">Unforeseen design modifications</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/non-normal_endpoints.html">Non-normal endpoints</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulating multi-arm multi-stage designs</h1>

      <div class="d-none name"><code>mams.sim.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function simulates multi-arm multi-stage designs and estimates power and
expected sample size.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mams.sim</span><span class="op">(</span>obj<span class="op">=</span><span class="cn">NULL</span>,nsim<span class="op">=</span><span class="cn">NULL</span>, nMat<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>u<span class="op">=</span><span class="cn">NULL</span>, l<span class="op">=</span><span class="cn">NULL</span>, pv<span class="op">=</span><span class="cn">NULL</span>, deltav<span class="op">=</span><span class="cn">NULL</span>, sd<span class="op">=</span><span class="cn">NULL</span>, ptest<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>parallel<span class="op">=</span><span class="cn">NULL</span>, H0<span class="op">=</span><span class="cn">NULL</span>, K <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-obj">obj<a class="anchor" aria-label="anchor" href="#arg-obj"></a></dt>
<dd><p>an object of class <code>MAMS</code>. The parameters/design of the
considered in the output of the <code><a href="MAMS.html">mams()</a></code> function are considered as
reference for the simulation. If other parameters are given, their values
<em>override</em> the parameters of the <code>MAMS</code> object</p></dd>


<dt id="arg-nsim">nsim<a class="anchor" aria-label="anchor" href="#arg-nsim"></a></dt>
<dd><p>Number of simulations (default=`50000“).</p></dd>


<dt id="arg-nmat">nMat<a class="anchor" aria-label="anchor" href="#arg-nmat"></a></dt>
<dd><p>Jx(K+1) dimensional matrix of observed/expected sample sizes.
Rows correspond to stages and columns to arms. First column is control
(default: <code>NULL</code>).</p></dd>


<dt id="arg-u">u<a class="anchor" aria-label="anchor" href="#arg-u"></a></dt>
<dd><p>Vector of previously used upper boundaries (default=<code>NULL</code>).</p></dd>


<dt id="arg-l">l<a class="anchor" aria-label="anchor" href="#arg-l"></a></dt>
<dd><p>Vector of previously used upper boundaries (default=<code>NULL</code>).</p></dd>


<dt id="arg-pv">pv<a class="anchor" aria-label="anchor" href="#arg-pv"></a></dt>
<dd><p>Vector of size K of true treatment effects on the probability
scale. See Details (default=<code>NULL</code>).</p></dd>


<dt id="arg-deltav">deltav<a class="anchor" aria-label="anchor" href="#arg-deltav"></a></dt>
<dd><p>Vector of size K of true treatment effects on the traditional
scale. See Details (default=<code>NULL</code>).</p></dd>


<dt id="arg-sd">sd<a class="anchor" aria-label="anchor" href="#arg-sd"></a></dt>
<dd><p>Standard deviation. See Details (default=<code>NULL</code>).</p></dd>


<dt id="arg-ptest">ptest<a class="anchor" aria-label="anchor" href="#arg-ptest"></a></dt>
<dd><p>Vector of treatment numbers for determining power.
For example, c(1, 2) will count rejections of one or both hypotheses for
testing treatments 1 and 2 against control (default=<code>1</code>).</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>if <code>TRUE</code> (default), allows parallelization of the
computation via a user-defined strategy specified by means of the function
<code><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></code>. If not set differently, the default
strategy is <code>sequential</code>, which corresponds to a computation without
parallelization.</p></dd>


<dt id="arg-h-">H0<a class="anchor" aria-label="anchor" href="#arg-h-"></a></dt>
<dd><p>if <code>TRUE</code> (default), the simulation also considers the case with
all effect sizes set to 0.</p></dd>


<dt id="arg-k">K<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>Allocation for treatment arms (used only with method = "dtl")</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object containing the following components:</p>
<dl><dt>l</dt>
<dd><p>Lower boundary.</p></dd>

<dt>u</dt>
<dd><p>Upper boundary.</p></dd>

<dt>n</dt>
<dd><p>Sample size on control in stage 1.</p></dd>

<dt>N</dt>
<dd><p>Maximum total sample size.</p></dd>

<dt>K</dt>
<dd><p>Number of experimental treatments.</p></dd>

<dt>J</dt>
<dd><p>Number of stages in the trial.</p></dd>

<dt>rMat</dt>
<dd><p>Matrix of allocation ratios. First row corresponds to control
and second row to experimental treatments.</p></dd>

<dt>nsim</dt>
<dd><p>Number of simulation runs.</p></dd>

<dt>typeI</dt>
<dd><p>The proportion any hypothesis is rejected.</p></dd>

<dt>power</dt>
<dd><p>The proportion the first hypothesis is rejected and the
corresponding test statistic is largest.</p></dd>

<dt>ptest</dt>
<dd><p>The vector <code>ptest</code>.</p></dd>

<dt>prop.rej</dt>
<dd><p>The proportion of times at least one of the hypothesis
specified by <code>ptest</code> is rejected.</p></dd>

<dt>exss</dt>
<dd><p>The expected sample size.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function simulates multi-arm multi-stage studies for a given matrix of
sample sizes and boundaries given by the vectors <code>u</code> and  <code>l</code>.
The effect difference between each experimental treatment and control is
given by <code>pv</code> and is parameterized as
\(P(X_k &gt; X_0 ) = p\).
That is the probability of a randomly selected person on treatment k
observing a better outcome than a random person on control.
For <code>pv=rep(0.5,4)</code> the experimental treatments and control perform equally
well (i.e. the global null hypothesis is true).
The advantage of this parameterization is that no knowledge about the
variance is required. To convert traditional effect sizes,
\(\delta\) to this format use
\(p=\Phi(\frac{\delta}{\sqrt{2}\sigma})\).
Alternatively, the effect size can also be specified directly on the
traditional scale of <code>deltav</code> with an additional specification of
the standard deviation <code>sd</code>.</p>
<p>he function returns the probability of rejecting any hypothesis (<code>typeI</code>),
the power to reject the first hypothesis when the first treatment has the
largest estimated effect, the proportion of rejections of the hypothesis
specified by <code>ptest</code> (<code>prop.rej</code>) as well as the expected
sample size.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Jaki T., Pallmann P., and Magirr D. (2019), <em>The R Package MAMS for
Designing Multi-Arm Multi-Stage Clinical Trials</em>, <b>Journal of
Statistical Software</b>, 88(4), 1-25. Link:
<a href="https://doi.org/10.18637/jss.v088.i04" class="external-link">doi:10.18637/jss.v088.i04</a></p>
<p>Magirr D., Jaki T., and Whitehead J. (2012), <em>A generalized Dunnett test
for multi-arm multi-stage clinical studies with treatment selection</em>,
<b>Biometrika</b>, 99(2), 494-501. Link:
<a href="https://doi.org/10.1093/biomet/ass002" class="external-link">doi:10.1093/biomet/ass002</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="MAMS.html">mams</a>.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Thomas Jaki, Dominic Magirr and Dominique-Laurent Couturier</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Note that some of these examples may take a few minutes to run</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 2-stage design with O'Brien &amp; Fleming efficacy and zero futility boundary</span></span></span>
<span class="r-in"><span><span class="co"># with equal sample size per arm and stage. Design can be found using</span></span></span>
<span class="r-in"><span><span class="co"># mams(K=4, J=2, alpha=0.05, power=0.9, r=1:2, r0=1:2, ushape="obf", </span></span></span>
<span class="r-in"><span>     <span class="co"># lshape="fixed",</span></span></span>
<span class="r-in"><span>     <span class="co"># lfix=0, p=0.65, p0=0.55)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># under global null hypothesis (using the pv scale)</span></span></span>
<span class="r-in"><span><span class="fu">mams.sim</span><span class="op">(</span>nsim<span class="op">=</span><span class="fl">10000</span>, nMat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">44</span>, <span class="fl">88</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">2</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>             u<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.068</span>, <span class="fl">2.169</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>             l<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.000</span>, <span class="fl">2.169</span><span class="op">)</span>, pv<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">4</span><span class="op">)</span>, ptest<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Standard deviation set to 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design parameters for a 2 stage trial with 4 treatments:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                             Stage 1 Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (control):      44      88</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (active):       44      88</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum total sample size:  440 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Stage 1 Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper bound:   3.068   2.169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower bound:   0.000   2.169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulated error rates based on 10000 simulations:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting at least 1 hypothesis:               0.047</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting first hypothesis (Z_1&gt;Z_2,...,Z_K)   0.011</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting hypothesis 1:                        0.013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected sample size:                              341.889</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># under global null hypothesis (using the deltav scale)</span></span></span>
<span class="r-in"><span><span class="fu">mams.sim</span><span class="op">(</span>nsim<span class="op">=</span><span class="fl">10000</span>, nMat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">44</span>, <span class="fl">88</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">2</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>        u<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.068</span>, <span class="fl">2.169</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        l<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.000</span>, <span class="fl">2.169</span><span class="op">)</span>, pv<span class="op">=</span><span class="cn">NULL</span>, deltav<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span>, sd<span class="op">=</span><span class="fl">1</span>, ptest<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design parameters for a 2 stage trial with 4 treatments:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                             Stage 1 Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (control):      44      88</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (active):       44      88</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum total sample size:  440 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Stage 1 Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper bound:   3.068   2.169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower bound:   0.000   2.169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulated error rates based on 10000 simulations:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting at least 1 hypothesis:               0.050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting first hypothesis (Z_1&gt;Z_2,...,Z_K)   0.013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting hypothesis 1:                        0.016</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected sample size:                              342.184</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># under LFC</span></span></span>
<span class="r-in"><span><span class="fu">mams.sim</span><span class="op">(</span>nsim<span class="op">=</span><span class="fl">10000</span>, nMat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">44</span>, <span class="fl">88</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">2</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>        u<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.068</span>, <span class="fl">2.169</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        l<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.000</span>, <span class="fl">2.169</span><span class="op">)</span>, pv<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.65</span>, <span class="fl">0.55</span>, <span class="fl">0.55</span>, <span class="fl">0.55</span><span class="op">)</span>, ptest<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Standard deviation set to 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design parameters for a 2 stage trial with 4 treatments:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                             Stage 1 Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (control):      44      88</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (active):       44      88</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum total sample size:  440 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Stage 1 Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper bound:   3.068   2.169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower bound:   0.000   2.169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulated error rates based on 10000 simulations:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting at least 1 hypothesis:               0.928</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting first hypothesis (Z_1&gt;Z_2,...,Z_K)   0.906</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting hypotheses 1 or 2:                   0.922</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected sample size:                              346.386</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># when all treatments doing similarly well</span></span></span>
<span class="r-in"><span><span class="fu">mams.sim</span><span class="op">(</span>nsim<span class="op">=</span><span class="fl">10000</span>, nMat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">44</span>, <span class="fl">88</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">2</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        u<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.068</span>, <span class="fl">2.169</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        l<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.000</span>, <span class="fl">2.169</span><span class="op">)</span>, pv<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.63</span>, <span class="fl">0.62</span>, <span class="fl">0.60</span>, <span class="fl">0.61</span><span class="op">)</span>, ptest<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Standard deviation set to 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design parameters for a 2 stage trial with 4 treatments:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                             Stage 1 Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (control):      44      88</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (active):       44      88</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum total sample size:  440 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Stage 1 Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper bound:   3.068   2.169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower bound:   0.000   2.169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulated error rates based on 10000 simulations:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting at least 1 hypothesis:               0.942</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting first hypothesis (Z_1&gt;Z_2,...,Z_K)   0.401</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting hypothesis 4:                        0.497</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected sample size:                              363.119</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##</span></span></span>
<span class="r-in"><span><span class="co">## example considering different parallelisation strategies</span></span></span>
<span class="r-in"><span><span class="co">##</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># parallel = FALSE (future framework not used)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">mams.sim</span><span class="op">(</span>nsim<span class="op">=</span><span class="fl">25000</span>, nMat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">44</span>, <span class="fl">88</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">2</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                u<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.068</span>, <span class="fl">2.169</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                l<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.000</span>, <span class="fl">2.169</span><span class="op">)</span>, pv<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.65</span>, <span class="fl">0.55</span>, <span class="fl">0.55</span>, <span class="fl">0.55</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                ptest<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, parallel<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Standard deviation set to 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design parameters for a 2 stage trial with 4 treatments:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                             Stage 1 Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (control):      44      88</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (active):       44      88</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum total sample size:  440 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Stage 1 Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper bound:   3.068   2.169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower bound:   0.000   2.169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulated error rates based on 25000 simulations:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting at least 1 hypothesis:               0.928</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting first hypothesis (Z_1&gt;Z_2,...,Z_K)   0.905</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting hypotheses 1 or 2:                   0.921</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected sample size:                              346.755</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5.83    0.22    6.35 </span>
<span class="r-in"><span><span class="co"># parallel = TRUE (default) with default strategy (sequential computation)</span></span></span>
<span class="r-in"><span><span class="fu">plan</span><span class="op">(</span><span class="va">sequential</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">mams.sim</span><span class="op">(</span>nsim<span class="op">=</span><span class="fl">25000</span>, nMat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">44</span>, <span class="fl">88</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">2</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                u<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.068</span>, <span class="fl">2.169</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                l<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.000</span>, <span class="fl">2.169</span><span class="op">)</span>, pv<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.65</span>, <span class="fl">0.55</span>, <span class="fl">0.55</span>, <span class="fl">0.55</span><span class="op">)</span>, ptest<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Standard deviation set to 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design parameters for a 2 stage trial with 4 treatments:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                             Stage 1 Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (control):      44      88</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (active):       44      88</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum total sample size:  440 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Stage 1 Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper bound:   3.068   2.169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower bound:   0.000   2.169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulated error rates based on 25000 simulations:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting at least 1 hypothesis:               0.928</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting first hypothesis (Z_1&gt;Z_2,...,Z_K)   0.905</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting hypotheses 1 or 2:                   0.921</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected sample size:                              346.755</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    8.84    0.45    9.70 </span>
<span class="r-in"><span><span class="co"># parallel = TRUE (default) with multisession strategy (parallel computation)</span></span></span>
<span class="r-in"><span><span class="fu">plan</span><span class="op">(</span><span class="va">multisession</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">mams.sim</span><span class="op">(</span>nsim<span class="op">=</span><span class="fl">25000</span>, nMat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">44</span>, <span class="fl">88</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">2</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                u<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.068</span>, <span class="fl">2.169</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                l<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.000</span>, <span class="fl">2.169</span><span class="op">)</span>, pv<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.65</span>, <span class="fl">0.55</span>, <span class="fl">0.55</span>, <span class="fl">0.55</span><span class="op">)</span>, ptest<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Standard deviation set to 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design parameters for a 2 stage trial with 4 treatments:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                             Stage 1 Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (control):      44      88</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (active):       44      88</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum total sample size:  440 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Stage 1 Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper bound:   3.068   2.169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower bound:   0.000   2.169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulated error rates based on 25000 simulations:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting at least 1 hypothesis:               0.928</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting first hypothesis (Z_1&gt;Z_2,...,Z_K)   0.905</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting hypotheses 1 or 2:                   0.921</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected sample size:                              346.755</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    6.72    0.54    9.78 </span>
<span class="r-in"><span><span class="fu">plan</span><span class="op">(</span><span class="st">"default"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Jaki, Dominique-Laurent Couturier, Dominic Magirr, Nikita Mozgunov, Philip Pallmann.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

