<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Function to design multi-arm multi-stage studies with normal endpoints — mams • MAMS</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Function to design multi-arm multi-stage studies with normal endpoints — mams"><meta name="description" content="The function determines the boundaries of a multi-arm multi-stage study
for a given boundary shape and finds the required number of subjects."><meta property="og:description" content="The function determines the boundaries of a multi-arm multi-stage study
for a given boundary shape and finds the required number of subjects."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MAMS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><h6 class="dropdown-header" data-toc-skip>Basics</h6></li>
    <li><a class="dropdown-item" href="../articles/web_only/reproducibility.html">Reproducibility</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/parallelisation.html">Parallelisation</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Design studies</h6></li>
    <li><a class="dropdown-item" href="../articles/web_only/single-stage_design.html">Single stage design</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/multi-stage_design.html">Multi-stage design</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/evaluating_properties.html">Design operating characteristics</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/step-down_design.html">A step-down design</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/unforeseen_design_modifications.html">Unforeseen design modifications</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/non-normal_endpoints.html">Non-normal endpoints</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Function to design multi-arm multi-stage studies with normal endpoints</h1>

      <div class="d-none name"><code>MAMS.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function determines the boundaries of a multi-arm multi-stage study
for a given boundary shape and finds the required number of subjects.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mams</span><span class="op">(</span>obj <span class="op">=</span> <span class="cn">NULL</span>, K<span class="op">=</span><span class="cn">NULL</span>, J<span class="op">=</span><span class="cn">NULL</span>, alpha<span class="op">=</span><span class="cn">NULL</span>, power<span class="op">=</span><span class="cn">NULL</span>, r<span class="op">=</span><span class="cn">NULL</span>, </span>
<span>                     r0<span class="op">=</span><span class="cn">NULL</span>, p<span class="op">=</span><span class="cn">NULL</span>, p0<span class="op">=</span><span class="cn">NULL</span>, delta<span class="op">=</span><span class="cn">NULL</span>, delta0<span class="op">=</span><span class="cn">NULL</span>, </span>
<span>                     sd<span class="op">=</span><span class="cn">NULL</span>,ushape<span class="op">=</span><span class="cn">NULL</span>, lshape<span class="op">=</span><span class="cn">NULL</span>, ufix<span class="op">=</span><span class="cn">NULL</span>, lfix<span class="op">=</span><span class="cn">NULL</span>, </span>
<span>                     nstart<span class="op">=</span><span class="cn">NULL</span>, nstop<span class="op">=</span><span class="cn">NULL</span>, sample.size<span class="op">=</span><span class="cn">NULL</span>, Q<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>                     type<span class="op">=</span><span class="cn">NULL</span>, parallel<span class="op">=</span><span class="cn">NULL</span>, print<span class="op">=</span><span class="cn">NULL</span>, nsim<span class="op">=</span><span class="cn">NULL</span>, </span>
<span>                     H0<span class="op">=</span><span class="cn">NULL</span>, method<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-obj">obj<a class="anchor" aria-label="anchor" href="#arg-obj"></a></dt>
<dd><p>object of class <code>MAMS</code></p></dd>


<dt id="arg-k">K<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>Number of experimental treatments (default=4).</p></dd>


<dt id="arg-j">J<a class="anchor" aria-label="anchor" href="#arg-j"></a></dt>
<dd><p>Number of stages (default=2).</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>One-sided familywise error rate (default=0.05).</p></dd>


<dt id="arg-power">power<a class="anchor" aria-label="anchor" href="#arg-power"></a></dt>
<dd><p>Desired power (default=0.9).</p></dd>


<dt id="arg-r">r<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>Vector of allocation ratios (default=1:2).</p></dd>


<dt id="arg-r-">r0<a class="anchor" aria-label="anchor" href="#arg-r-"></a></dt>
<dd><p>Vector ratio on control (default=1:2).</p></dd>


<dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>Interesting treatment effect on the probability scale.
See Details (default=0.75).</p></dd>


<dt id="arg-p-">p0<a class="anchor" aria-label="anchor" href="#arg-p-"></a></dt>
<dd><p>Uninteresting treatment effect on the probability scale.
See Details (default=0.5). Note that this parameter affects the sample size
estimation to ensure that Treatment 1 is best only when selecting the
simultaneous stopping rule (i.e., 'method = "simultaneous"') and, for all
methods, as values for treatment arms 2 to K in the simulations under H1.</p></dd>


<dt id="arg-delta">delta<a class="anchor" aria-label="anchor" href="#arg-delta"></a></dt>
<dd><p>Interesting treatment effect on the traditional scale.
See Details (default=NULL).</p></dd>


<dt id="arg-delta-">delta0<a class="anchor" aria-label="anchor" href="#arg-delta-"></a></dt>
<dd><p>Uninteresting treatment effect on the traditional scale.
See Details (default=NULL). Note that this parameter affects the sample size
estimation to ensure that Treatment 1 is best only when selecting the
simultaneous stopping rule (i.e., 'method = "simultaneous"') and, for all
methods, as values for treatment arms 2 to K in the simulations under H1.</p></dd>


<dt id="arg-sd">sd<a class="anchor" aria-label="anchor" href="#arg-sd"></a></dt>
<dd><p>Standard deviation, assumed to be known.
See Details (default=NULL).</p></dd>


<dt id="arg-ushape">ushape<a class="anchor" aria-label="anchor" href="#arg-ushape"></a></dt>
<dd><p>Shape of upper boundary. Either a function specifying the shape
or one of "pocock", "obf" (the default), "triangular" and "fixed".
See details.</p></dd>


<dt id="arg-lshape">lshape<a class="anchor" aria-label="anchor" href="#arg-lshape"></a></dt>
<dd><p>Shape of lower boundary. Either a function specifying the shape
or one of "pocock", "obf", "triangular" and "fixed" (the default).
See details.</p></dd>


<dt id="arg-ufix">ufix<a class="anchor" aria-label="anchor" href="#arg-ufix"></a></dt>
<dd><p>Fixed upper boundary (default=NULL). Only used if shape="fixed".</p></dd>


<dt id="arg-lfix">lfix<a class="anchor" aria-label="anchor" href="#arg-lfix"></a></dt>
<dd><p>Fixed lower boundary (default=0). Only used if shape="fixed".</p></dd>


<dt id="arg-nstart">nstart<a class="anchor" aria-label="anchor" href="#arg-nstart"></a></dt>
<dd><p>Starting point for finding the sample size (default=1).</p></dd>


<dt id="arg-nstop">nstop<a class="anchor" aria-label="anchor" href="#arg-nstop"></a></dt>
<dd><p>Stopping point for finding the sample size (default=NULL).</p></dd>


<dt id="arg-sample-size">sample.size<a class="anchor" aria-label="anchor" href="#arg-sample-size"></a></dt>
<dd><p>Logical if sample size should be found as well
(default=TRUE).</p></dd>


<dt id="arg-q">Q<a class="anchor" aria-label="anchor" href="#arg-q"></a></dt>
<dd><p>Number of quadrature points per dimension in the outer integral
(default=20).</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Will be changed automatically by the wrappers tite.mams()
(to "tite") and ordinal.mams() (to "ordinal") to customise the output.</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>if TRUE (default), allows parallelization of the computation
via a user-defined strategy specified by means of the function
future::plan().
If not set differently, the default strategy is sequential, which
corresponds to a computation without parallelization.</p></dd>


<dt id="arg-print">print<a class="anchor" aria-label="anchor" href="#arg-print"></a></dt>
<dd><p>if TRUE (default), indicate at which stage the computation is.</p></dd>


<dt id="arg-nsim">nsim<a class="anchor" aria-label="anchor" href="#arg-nsim"></a></dt>
<dd><p>a scalar indicating the number of simulations (default = 50'000,
minimum = 1000)</p></dd>


<dt id="arg-h-">H0<a class="anchor" aria-label="anchor" href="#arg-h-"></a></dt>
<dd><p>if TRUE (default), the simulation also considers the case with all
effect sizes set to 0.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Type of the desired design: <code>simultaneous</code>(default) for
simultaneous stopping rules, <code>sep</code> for separate stopping, and <code>dtl</code>
for drop-the-losers design.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of the class MAMS containing the following components:</p>
<dl><dt>l</dt>
<dd><p>Lower boundary.</p></dd>

<dt>u</dt>
<dd><p>Upper boundary.</p></dd>

<dt>n</dt>
<dd><p>Sample size on control in stage 1.</p></dd>

<dt>N</dt>
<dd><p>Maximum total sample size.</p></dd>

<dt>K</dt>
<dd><p>Number of experimental treatments.</p></dd>

<dt>J</dt>
<dd><p>Number of stages in the trial.</p></dd>

<dt>alpha</dt>
<dd><p>Familywise error rate.</p></dd>

<dt>alpha.star</dt>
<dd><p>Cumulative familywise error rate spent by each analysis.</p></dd>

<dt>power</dt>
<dd><p>Power under least favorable configuration.</p></dd>

<dt>rMat</dt>
<dd><p>Matrix of allocation ratios. First row corresponds to control
while subsequent rows are for the experimental treatments.</p></dd>

<dt>sim</dt>
<dd><p>a list indicating, for each hypothesis of interest (null and/or
alternative), the expected sample size and standard deviation per group
(ess), the cumulated probability of efficacy (efficacy) and futility
(futility) per treatment arm and look</p></dd>

<dt>input</dt>
<dd><p>the list of all input parameters except K and J</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function finds the boundaries and sample size of a multi-arm multi-stage
study with K active treatments plus control in which all promising
treatments are continued at interim analyses as described in
Magirr et al (2012). At each interim analysis the test statistics are
compared to the lower (futility) bound and any treatment whose corresponding
test statistic falls below that bound is discontinued. Similarly if any test
statistic exceeds the upper (efficacy) bound the null hypothesis
corresponding to that treatment can be rejected and superiority of that
treatment over control claimed. At the same time the study is stopped.
If at least one test statistic exceeds the lower bound and none exceeds the
upper bound the study is continued and further patients are recruited to all
remaining experimental treatments plus control.</p>
<p>The design is found under the least favorable configuration, which requires
an interesting treatment effect <code>p</code> that if present we would like to find
with
high probability and an uninteresting effect <code>p0</code>. Both <code>p</code> and <code>p0</code> are
parameterized as \(P(X_k &gt; X_0 ) = p\), that is the
probability of a randomly selected person on treatment k observing a
better outcome than a random person on control. For <code>p=0.5</code> the experimental
treatment and control perform equally well.
The advantage of this parameterization is that no knowledge about the
variance is required. To convert traditional effect sizes,
d\(\delta\)
to this format use
\(p=\Phi(\frac{\delta}{\sqrt{2}\sigma})\).
Alternatively, the interesting and uninteresting effect size can also be
specified directly on the traditional scale of <code>delta</code> and <code>delta</code> with an
additional specification of the standard deviation <code>sd</code> assumed to be known.</p>
<p>The shape of the boundaries (<code>ushape</code>, <code>lshape</code>) are either using the
predefined shapes following Pocock (1977), O'Brien &amp; Fleming (1979) or the
triangular Test (Whitehead, 1997) using options "<code>pocock"</code>, <code>"obf"</code>or
<code>"triangular"</code> respectively, are constant (option <code>"fixed"</code>) or supplied
in as a function.
If a function is passed it should require exactly one argument specifying
the number of stages and return a vector of the same length. The lower
boundary shape is required to be non-decreasing while the upper boundary
shape needs to be non-increasing. If a fixed lower boundary is used, <code>lfix</code>
must be smaller than \(\Phi^{-1}(1-\alpha)/2\)
to ensure that it is smaller than the upper boundary.</p>
<p>The default starting point for finding the sample size is <code>nstart=1</code>, and
the default point where the search is stopped (when <code>nstop=NULL</code>) is 3
times the sample size of the corresponding fixed single-stage design.</p>
<p>Computation of designs with more than four stages are very time consuming
and not advised. The parameter <code>sample.size</code> controls whether the required
sample size is computed as well. Setting to <code>FALSE</code> approximately halves
the computation time.</p>
<p>For designs with more than 2 stages, parallelization of the computation by
means of the packages <span class="pkg">future</span> and <span class="pkg">future.apply</span> lead to decreased
computation times when choosing a parallelization strategy like, for
example, <code>multicore</code> (using separate forked R processes, available to
unix/osx users) or <code>multisession</code> (using separate R sessions, available
to all users) (refer to <a href="https://future.futureverse.org/reference/plan.html" class="external-link">future::plan()</a> for detail).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Jaki T., Pallmann P., and Magirr D. (2019), <em>The R Package MAMS for
Designing Multi-Arm Multi-Stage Clinical Trials</em>, <b>Journal of
Statistical Software</b>, 88(4), 1-25. Link:
<a href="https://doi.org/10.18637/jss.v088.i04" class="external-link">doi:10.18637/jss.v088.i04</a></p>
<p>Magirr D., Jaki T., and Whitehead J. (2012), <em>A generalized Dunnett test
for multi-arm multi-stage clinical studies with treatment selection</em>,
<b>Biometrika</b>, 99(2), 494-501. Link:
<a href="https://doi.org/10.1093/biomet/ass002" class="external-link">doi:10.1093/biomet/ass002</a></p>
<p>Pocock S.J. (1977), <em>Group sequential methods in the design and analysis
of clinical trials</em>, <b>Biometrika</b>, 64(2), 191-199.</p>
<p>O'Brien P.C., and Fleming T.R. (1979), <em>A multiple testing procedure for
clinical trials</em>, <b>Biometrics</b>, 35(3), 549-556.</p>
<p>Whitehead J. (1997), <em>The Design and Analysis of Sequential
Clinical Trials</em>, <b>Wiley</b>: Chichester, UK.
Wason J, Stallard N, Bowden J, Jennison C. A multi-stage drop-the-losers
design for multi-arm clinical trials. Statistical Methods in Medical
Research. 2017;26(1):508-524. doi:10.1177/0962280214550759</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="new.bounds.html">new.bounds</a>, <a href="ordinal.mams.html">ordinal.mams</a>, <a href="tite.mams.html">tite.mams</a>.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Thomas Jaki, Dominic Magirr, Dominique-Laurent Couturier
and Nikita Mozgunov</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">## A fixed sample (single stage) design specified on the p scale</span></span></span>
<span class="r-in"><span><span class="fu">mams</span><span class="op">(</span>K<span class="op">=</span><span class="fl">4</span>, J<span class="op">=</span><span class="fl">1</span>, alpha<span class="op">=</span><span class="fl">0.05</span>, power<span class="op">=</span><span class="fl">0.9</span>, r<span class="op">=</span><span class="fl">1</span>, r0<span class="op">=</span><span class="fl">1</span>, p<span class="op">=</span><span class="fl">0.65</span>, p0<span class="op">=</span><span class="fl">0.55</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    i) find lower and upper boundaries</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   ii) define alpha star</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  iii) perform sample size calculation</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       (maximum iteration number = 252)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 50</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   iv) run simulation </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design parameters for a 1 stage trial with 4 treatments:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                             Stage 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (control):      84</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (active):       84</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum total sample size:  420 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Stage 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper bound:    2.16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower bound:    2.16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulated error rates based on 50000 simulations:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting at least 1 hypothesis:               0.917</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting first hypothesis (Z_1&gt;Z_2,...,Z_K)   0.902</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting hypothesis 1:                        0.914</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected sample size:                              420.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The same design specified on the delta scale</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">mams</span><span class="op">(</span>K<span class="op">=</span><span class="fl">4</span>, J<span class="op">=</span><span class="fl">1</span>, alpha<span class="op">=</span><span class="fl">0.05</span>, power<span class="op">=</span><span class="fl">0.9</span>, r<span class="op">=</span><span class="fl">1</span>, r0<span class="op">=</span><span class="fl">1</span>, p<span class="op">=</span><span class="cn">NULL</span>, p0<span class="op">=</span><span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>     delta<span class="op">=</span><span class="fl">0.545</span>, delta0<span class="op">=</span><span class="fl">0.178</span>, sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    i) find lower and upper boundaries</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   ii) define alpha star</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  iii) perform sample size calculation</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       (maximum iteration number = 252)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 50</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   iv) run simulation </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design parameters for a 1 stage trial with 4 treatments:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                             Stage 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (control):      84</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (active):       84</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum total sample size:  420 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Stage 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper bound:    2.16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower bound:    2.16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulated error rates based on 50000 simulations:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting at least 1 hypothesis:               0.917</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting first hypothesis (Z_1&gt;Z_2,...,Z_K)   0.901</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting hypothesis 1:                        0.914</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected sample size:                              420.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## An example in Table 1 of Magirr et al (2012)</span></span></span>
<span class="r-in"><span><span class="co"># 2-stage design with O'Brien &amp; Fleming efficacy and zero futility boundary</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">mams</span><span class="op">(</span>K<span class="op">=</span><span class="fl">4</span>, J<span class="op">=</span><span class="fl">2</span>, alpha<span class="op">=</span><span class="fl">0.05</span>, power<span class="op">=</span><span class="fl">0.9</span>, r<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, r0<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, p<span class="op">=</span><span class="fl">0.65</span>, p0<span class="op">=</span><span class="fl">0.55</span>,</span></span>
<span class="r-in"><span>     ushape<span class="op">=</span><span class="st">"obf"</span>, lshape<span class="op">=</span><span class="st">"fixed"</span>, lfix<span class="op">=</span><span class="fl">0</span>, nstart<span class="op">=</span><span class="fl">40</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    i) find lower and upper boundaries</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   ii) define alpha star</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  iii) perform sample size calculation</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       (maximum iteration number = 348)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   iv) run simulation </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design parameters for a 2 stage trial with 4 treatments:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                             Stage 1 Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (control):      44      88</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (active):       44      88</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum total sample size:  440 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Stage 1 Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper bound:   3.068   2.169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower bound:   0.000   2.169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulated error rates based on 50000 simulations:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting at least 1 hypothesis:               0.929</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting first hypothesis (Z_1&gt;Z_2,...,Z_K)   0.907</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting hypothesis 1:                        0.920</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected sample size:                              346.422</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## An example of separate stopping rules</span></span></span>
<span class="r-in"><span><span class="co"># 2-stage design with O'Brien &amp; Fleming efficacy and zero futility boundary</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">mams</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"sep"</span>,K<span class="op">=</span><span class="fl">4</span>, J<span class="op">=</span><span class="fl">2</span>, alpha<span class="op">=</span><span class="fl">0.05</span>, power<span class="op">=</span><span class="fl">0.9</span>, r<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, r0<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, </span></span>
<span class="r-in"><span>       p<span class="op">=</span><span class="fl">0.65</span>, p0<span class="op">=</span><span class="fl">0.55</span>, ushape<span class="op">=</span><span class="st">"obf"</span>, lshape<span class="op">=</span><span class="st">"fixed"</span>, lfix<span class="op">=</span><span class="fl">0</span>, nstart<span class="op">=</span><span class="fl">40</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    i) find lower and upper boundaries</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    ii) perform sample size calculation</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    iii) run simulation </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design parameters for a 2 stage separate stopping rules trial with K = 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                             Stage 1 Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (control):      41      82</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (active):       41      82</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Required total sample size:  410 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Stage 1 Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper bound:   3.068   2.169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower bound:   0.000   2.169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulated error rates based on 50000 simulations:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting at least 1 hypothesis:               0.909</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting first hypothesis (Z_1&gt;Z_2,...,Z_K)   0.756</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting hypothesis 1:                        0.904</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected sample size:                              371.080</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># An example of running drop-the-losers design </span></span></span>
<span class="r-in"><span><span class="co"># `K` should be defined as vector length of J defining allocation arms per </span></span></span>
<span class="r-in"><span><span class="co"># stages with final element equal to 1.</span></span></span>
<span class="r-in"><span><span class="fu">mams</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"dtl"</span>, K<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">1</span><span class="op">)</span>, J<span class="op">=</span><span class="fl">2</span>, alpha<span class="op">=</span><span class="fl">0.05</span>,  </span></span>
<span class="r-in"><span>         power<span class="op">=</span><span class="fl">0.9</span>, r<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, r0<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, p<span class="op">=</span><span class="fl">0.65</span>, p0<span class="op">=</span><span class="fl">0.55</span>, ushape<span class="op">=</span><span class="st">"obf"</span>, </span></span>
<span class="r-in"><span>         lshape<span class="op">=</span><span class="st">"fixed"</span>, lfix<span class="op">=</span><span class="fl">0</span>, nstart<span class="op">=</span><span class="fl">40</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    i) find new lower and upper boundaries</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    ii) perform sample size calculation</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    iii) run simulation </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design parameters for a 2 stage drop-the-losers trial with Kv = (4, 1) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                             Stage 1 Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (control):      52     104</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (active):       52     104</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Required total sample size:  364 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Stage 1 Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper bound:      NA   2.055</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower bound:      NA   2.055</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulated error rates based on 50000 simulations:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting at least 1 hypothesis:               0.943</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting first hypothesis (Z_1&gt;Z_2,...,Z_K)   0.902</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting hypothesis 1:                        0.902</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected sample size:                              364.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note that these examples may take a few minutes to run</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## 3-stage design with Triangular efficacy and futility boundary</span></span></span>
<span class="r-in"><span><span class="fu">mams</span><span class="op">(</span>K<span class="op">=</span><span class="fl">4</span>, J<span class="op">=</span><span class="fl">3</span>, alpha<span class="op">=</span><span class="fl">0.05</span>, power<span class="op">=</span><span class="fl">0.9</span>, r<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, r0<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, p<span class="op">=</span><span class="fl">0.65</span>, p0<span class="op">=</span><span class="fl">0.55</span>,</span></span>
<span class="r-in"><span>  ushape<span class="op">=</span><span class="st">"triangular"</span>, lshape<span class="op">=</span><span class="st">"triangular"</span>, nstart<span class="op">=</span><span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    i) find lower and upper boundaries</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   ii) define alpha star</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  iii) perform sample size calculation</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       (maximum iteration number = 298)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   iv) run simulation </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design parameters for a 3 stage trial with 4 treatments:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                             Stage 1 Stage 2 Stage 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (control):      36      72     108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (active):       36      72     108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum total sample size:  540 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Stage 1 Stage 2 Stage 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper bound:   2.706   2.392   2.344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower bound:   0.000   1.435   2.344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulated error rates based on 50000 simulations:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting at least 1 hypothesis:               0.941</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting first hypothesis (Z_1&gt;Z_2,...,Z_K)   0.903</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting hypothesis 1:                        0.921</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected sample size:                              284.813</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Different allocation ratios between control and experimental treatments.</span></span></span>
<span class="r-in"><span><span class="co">## Twice as many patients are randomized to control at each stage.</span></span></span>
<span class="r-in"><span>  <span class="fu">mams</span><span class="op">(</span>K<span class="op">=</span><span class="fl">4</span>, J<span class="op">=</span><span class="fl">2</span>, alpha<span class="op">=</span><span class="fl">0.05</span>, power<span class="op">=</span><span class="fl">0.9</span>, r<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, r0<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>, p<span class="op">=</span><span class="fl">0.65</span>, </span></span>
<span class="r-in"><span>  p0<span class="op">=</span><span class="fl">0.55</span>, ushape<span class="op">=</span><span class="st">"obf"</span>, lshape<span class="op">=</span><span class="st">"fixed"</span>, lfix<span class="op">=</span><span class="fl">0</span>, nstart<span class="op">=</span><span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    i) find lower and upper boundaries</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   ii) define alpha star</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  iii) perform sample size calculation</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       (maximum iteration number = 271)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   iv) run simulation </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design parameters for a 2 stage trial with 4 treatments:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                             Stage 1 Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (control):      70     140</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (active):       35      70</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum total sample size:  420 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Stage 1 Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper bound:    3.12   2.206</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower bound:    0.00   2.206</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulated error rates based on 50000 simulations:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting at least 1 hypothesis:               0.944</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting first hypothesis (Z_1&gt;Z_2,...,Z_K)   0.904</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting hypothesis 1:                        0.926</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected sample size:                              334.666</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">##</span></span></span>
<span class="r-in"><span>  <span class="co">## example considering different parallelization strategies</span></span></span>
<span class="r-in"><span>  <span class="co">##</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># parallel = FALSE (future framework not used)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">mams</span><span class="op">(</span>K<span class="op">=</span><span class="fl">4</span>, J<span class="op">=</span><span class="fl">3</span>, alpha<span class="op">=</span><span class="fl">0.05</span>, power<span class="op">=</span><span class="fl">0.9</span>, r<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, r0<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,</span></span>
<span class="r-in"><span>          p<span class="op">=</span><span class="fl">0.65</span>, p0<span class="op">=</span><span class="fl">0.55</span>, ushape<span class="op">=</span><span class="st">"triangular"</span>, lshape<span class="op">=</span><span class="st">"triangular"</span>,</span></span>
<span class="r-in"><span>          nstart<span class="op">=</span><span class="fl">30</span>, parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>          <span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    i) find lower and upper boundaries</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   ii) define alpha star</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  iii) perform sample size calculation</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       (maximum iteration number = 298)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   iv) run simulation </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design parameters for a 3 stage trial with 4 treatments:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                             Stage 1 Stage 2 Stage 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (control):      36      72     108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (active):       36      72     108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum total sample size:  540 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Stage 1 Stage 2 Stage 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper bound:   2.706   2.392   2.344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower bound:   0.000   1.435   2.344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulated error rates based on 50000 simulations:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting at least 1 hypothesis:               0.944</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting first hypothesis (Z_1&gt;Z_2,...,Z_K)   0.906</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting hypothesis 1:                        0.922</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected sample size:                              284.913</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   90.58    1.35   95.54 </span>
<span class="r-in"><span> <span class="co"># parallel = TRUE (default) with default strategy (sequential computation)</span></span></span>
<span class="r-in"><span> <span class="fu">plan</span><span class="op">(</span><span class="va">sequential</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">mams</span><span class="op">(</span>K<span class="op">=</span><span class="fl">4</span>, J<span class="op">=</span><span class="fl">3</span>, alpha<span class="op">=</span><span class="fl">0.05</span>, power<span class="op">=</span><span class="fl">0.9</span>, r<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, r0<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,</span></span>
<span class="r-in"><span>          p<span class="op">=</span><span class="fl">0.65</span>, p0<span class="op">=</span><span class="fl">0.55</span>, ushape<span class="op">=</span><span class="st">"triangular"</span>, lshape<span class="op">=</span><span class="st">"triangular"</span>, </span></span>
<span class="r-in"><span>          nstart<span class="op">=</span><span class="fl">30</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>          <span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    i) find lower and upper boundaries</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   ii) define alpha star</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  iii) perform sample size calculation</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       (maximum iteration number = 298)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   iv) run simulation </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design parameters for a 3 stage trial with 4 treatments:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                             Stage 1 Stage 2 Stage 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (control):      36      72     108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (active):       36      72     108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum total sample size:  540 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Stage 1 Stage 2 Stage 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper bound:   2.706   2.392   2.344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower bound:   0.000   1.435   2.344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulated error rates based on 50000 simulations:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting at least 1 hypothesis:               0.942</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting first hypothesis (Z_1&gt;Z_2,...,Z_K)   0.904</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting hypothesis 1:                        0.922</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected sample size:                              284.486</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  143.41    2.48  154.93 </span>
<span class="r-in"><span> <span class="co"># parallel = TRUE(default) with multisession strategy (parallel computation)</span></span></span>
<span class="r-in"><span> <span class="fu">plan</span><span class="op">(</span><span class="va">multisession</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">mams</span><span class="op">(</span>K<span class="op">=</span><span class="fl">4</span>, J<span class="op">=</span><span class="fl">3</span>, alpha<span class="op">=</span><span class="fl">0.05</span>, power<span class="op">=</span><span class="fl">0.9</span>, r<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, r0<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, </span></span>
<span class="r-in"><span>          p<span class="op">=</span><span class="fl">0.65</span>, p0<span class="op">=</span><span class="fl">0.55</span>, ushape<span class="op">=</span><span class="st">"triangular"</span>, lshape<span class="op">=</span><span class="st">"triangular"</span>,</span></span>
<span class="r-in"><span>           nstart<span class="op">=</span><span class="fl">30</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>          <span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    i) find lower and upper boundaries</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   ii) define alpha star</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  iii) perform sample size calculation</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       (maximum iteration number = 298)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   iv) run simulation </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design parameters for a 3 stage trial with 4 treatments:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                             Stage 1 Stage 2 Stage 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (control):      36      72     108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (active):       36      72     108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum total sample size:  540 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Stage 1 Stage 2 Stage 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper bound:   2.706   2.392   2.344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower bound:   0.000   1.435   2.344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulated error rates based on 50000 simulations:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting at least 1 hypothesis:               0.942</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting first hypothesis (Z_1&gt;Z_2,...,Z_K)   0.904</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prop. rejecting hypothesis 1:                        0.922</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected sample size:                              284.486</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   42.28    2.13   63.78 </span>
<span class="r-in"><span>          <span class="fu">plan</span><span class="op">(</span><span class="st">"default"</span><span class="op">)</span></span></span>
<span class="r-in"><span>          <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Jaki, Dominique-Laurent Couturier, Dominic Magirr, Nikita Mozgunov, Philip Pallmann.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

