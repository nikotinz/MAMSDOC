<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The function determines the boundaries of a multi-arm multi-stage study for a given boundary shape and finds the required number of subjects."><title>Function to design multi-arm multi-stage studies with normal endpoints — mams • MAMS</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Function to design multi-arm multi-stage studies with normal endpoints — mams"><meta property="og:description" content="The function determines the boundaries of a multi-arm multi-stage study for a given boundary shape and finds the required number of subjects."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MAMS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tutorials">Tutorials</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tutorials">
    <h6 class="dropdown-header" data-toc-skip>Basics</h6>
    <a class="dropdown-item" href="../articles/web_only/reproducibility.html">Reproducibility</a>
    <a class="dropdown-item" href="../articles/web_only/parallelisation.html">Parallelisation</a>
    <h6 class="dropdown-header" data-toc-skip>Design studies</h6>
    <a class="dropdown-item" href="../articles/web_only/single-stage_design.html">Single stage design</a>
    <a class="dropdown-item" href="../articles/web_only/multi-stage_design.html">Multi-stage design</a>
    <a class="dropdown-item" href="../articles/web_only/evaluating_properties.html">Desing operating charachteristics</a>
    <a class="dropdown-item" href="../articles/web_only/step-down_design.html">A step-down design</a>
    <a class="dropdown-item" href="../articles/web_only/unforeseen_design_modifications.html">Unforeseen design modifications</a>
    <a class="dropdown-item" href="../articles/web_only/non-normal_endpoints.html">Non-normal endpoints</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Function to design multi-arm multi-stage studies with normal endpoints</h1>
      
      <div class="d-none name"><code>mams.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function determines the boundaries of a multi-arm multi-stage study for a given boundary shape and finds the required number of subjects.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mams</span><span class="op">(</span>K<span class="op">=</span><span class="fl">4</span>, J<span class="op">=</span><span class="fl">2</span>, alpha<span class="op">=</span><span class="fl">0.05</span>, power<span class="op">=</span><span class="fl">0.9</span>, r<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, r0<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, p<span class="op">=</span><span class="fl">0.75</span>, p0<span class="op">=</span><span class="fl">0.5</span>, </span>
<span>     delta<span class="op">=</span><span class="cn">NULL</span>, delta0<span class="op">=</span><span class="cn">NULL</span>, sd<span class="op">=</span><span class="cn">NULL</span>, ushape<span class="op">=</span><span class="st">"obf"</span>, lshape<span class="op">=</span><span class="st">"fixed"</span>,</span>
<span>     ufix<span class="op">=</span><span class="cn">NULL</span>, lfix<span class="op">=</span><span class="fl">0</span>, nstart<span class="op">=</span><span class="fl">1</span>, nstop<span class="op">=</span><span class="cn">NULL</span>, sample.size<span class="op">=</span><span class="cn">TRUE</span>, N<span class="op">=</span><span class="fl">20</span>,</span>
<span>     type<span class="op">=</span><span class="st">"normal"</span>, parallel<span class="op">=</span><span class="cn">TRUE</span>, print<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>K</dt>
<dd><p>Number of experimental treatments (default=<code>4</code>).</p></dd>

  <dt>J</dt>
<dd><p>Number of stages (default=<code>2</code>).</p></dd>

  <dt>alpha</dt>
<dd><p>One-sided familywise error rate (default=<code>0.05</code>).</p></dd>

  <dt>power</dt>
<dd><p>Desired power (default=<code>0.9</code>).</p></dd>

  <dt>r</dt>
<dd><p>Vector of allocation ratios (default=<code>1:2</code>).</p></dd>

  <dt>r0</dt>
<dd><p>Vector ratio on control (default=<code>1:2</code>).</p></dd>

  <dt>p</dt>
<dd><p>Interesting treatment effect on the probability scale. See Details (default=<code>0.75</code>).</p></dd>

  <dt>p0</dt>
<dd><p>Uninteresting treatment effect on the probability scale. See Details (default=<code>0.5</code>).</p></dd>

  <dt>delta</dt>
<dd><p>Interesting treatment effect on the traditional scale. See Details (default=<code>NULL</code>).</p></dd>

  <dt>delta0</dt>
<dd><p>Uninteresting treatment effect on the traditional scale. See Details (default=<code>NULL</code>).</p></dd>

  <dt>sd</dt>
<dd><p>Standard deviation, assumed to be known. See Details (default=<code>NULL</code>).</p></dd>

  <dt>ushape</dt>
<dd><p>Shape of upper boundary. Either a function specifying the shape or one of <code>"pocock"</code>, <code>"obf"</code> (the default), <code>"triangular"</code> and <code>"fixed"</code>. See details.</p></dd>

  <dt>lshape</dt>
<dd><p>Shape of lower boundary. Either a function specifying the shape or one of <code>"pocock"</code>, <code>"obf"</code>, <code>"triangular"</code> and <code>"fixed"</code> (the default). See details.</p></dd>

  <dt>ufix</dt>
<dd><p>Fixed upper boundary (default=<code>NULL</code>). Only used if <code>shape="fixed"</code>.</p></dd>

  <dt>lfix</dt>
<dd><p>Fixed lower boundary (default=<code>0</code>). Only used if <code>shape="fixed"</code>.</p></dd>

  <dt>nstart</dt>
<dd><p>Starting point for finding the sample size (default=<code>1</code>).</p></dd>

  <dt>nstop</dt>
<dd><p>Stopping point for finding the sample size (default=<code>NULL</code>).</p></dd>

  <dt>sample.size</dt>
<dd><p>Logical if sample size should be found as well (default=<code>TRUE</code>).</p></dd>

  <dt>N</dt>
<dd><p>Number of quadrature points per dimension in the outer integral (default=<code>20</code>).</p></dd>

  <dt>type</dt>
<dd><p>Will be changed automatically by the wrappers <code><a href="tite.mams.html">tite.mams()</a></code> (to <code>"tite"</code>) and <code><a href="ordinal.mams.html">ordinal.mams()</a></code> (to <code>"ordinal"</code>) to customise the output.</p></dd>

  <dt>parallel</dt>
<dd><p>if <code>TRUE</code> (default), allows parallelisation of the computation via a user-defined strategy specified by means of the function <code><a href="https://future.futureverse.org/reference/plan.html" class="external-link">future::plan()</a></code>. If not set differently, the default strategy is <code>sequential</code>, which corresponds to a computation without parallelisation.</p></dd>

  <dt>print</dt>
<dd><p>if <code>TRUE</code> (default), indicate at which stage the computation is.</p></dd>

  
</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function finds the boundaries and sample size of a multi-arm multi-stage study with K active treatments plus control in which all promising treatments are continued at interim analyses as described in Magirr et al (2012). At each interim analysis the test statistics are compared to the lower (futility) bound and any treatment whose corresponding test statistic falls below that bound is discontinued. Similarly if any test statistic exceeds the upper (efficacy) bound the null hypothesis corresponding to that treatment can be rejected and superiority of that treatment over control claimed. At the same time the study is stopped. If at least one test statistic exceeds the lower bound and none exceeds the upper bound the study is continued and further patients are recruited to all remaining experimental treatments plus control.<br></p>
<p>The design is found under the least favorable configuration, which requires an interesting treatment effect <code>p</code> that if present we would like to find with high probability and an uninteresting effect <code>p0</code>. Both <code>p</code> and <code>p0</code> are parameterized as \(P(X_k &gt; X_0 ) = p\), that is the probability of a randomly selected person on treatment k observing a better outcome than a random person on control. For <code>p=0.5</code> the experimental treatment and control perform equally well. The advantage of this paramterization is that no knowledge about the variance is required. To convert traditional effect sizes, \(\delta\) to this format use \(p=\Phi(\frac{\delta}{\sqrt{2}\sigma})\). Alternatively, the interesting and uninteresting effect size can also be specified directly on the traditional scale of <code>delta</code> and <code>delta</code> with an additional specification of the standard deviation <code>sd</code> assumed to be known.<br></p>
<p>The shape of the boundaries (<code>ushape</code>, <code>lshape</code>) are either using the predefined shapes following Pocock (1977), O'Brien &amp; Fleming (1979) or the triangular Test (Whitehead, 1997) using options <code>"pocock"</code>, <code>"obf"</code> or <code>"triangular"</code> respectively, are constant (option <code>"fixed"</code>) or supplied in as a function. If a function is passed it should require exactly one argument specifying the number of stages and return a vector of the same length. The lower boundary shape is required to be non-decreasing while the upper boundary shape needs to be non-increasing. If a fixed lower boundary is used, <code>lfix</code> must be smaller than \(\Phi^{-1}(1-\alpha)/2\) to ensure that it is smaller than the upper boundary.<br></p>
<p>The default starting point for finding the sample size is <code>nstart=1</code>, and the default point where the search is stopped (when <code>nstop=NULL</code>) is 3 times the sample size of the corresponding fixed single-stage design.<br></p>
<p>Computation of designs with more than four stages are very time consuming and not advised. The parameter <code>sample.size</code> controls whether the required sample size is computed as well. Setting to <code>FALSE</code> approximately halves the compuation time.</p>
<p>For designs with more than 2 stages, parallelisation of the computation by means of the packages <code>future</code> and <code>future.apply</code> lead to decreased computation times when choosing a parallelisation strategy like, for example, <code>multicore</code> (using separate forked <span class="pkg">R</span> processes, available to unix/osx users) or <code>multisession</code> (using separate <span class="pkg">R</span> sessions, available to all users) (refer to <code><a href="https://future.futureverse.org/reference/plan.html" class="external-link">future::plan()</a></code> for detail). <br></p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of the class MAMS containing the following components:<br></p>
<dl><dt>l</dt>
<dd><p>Lower boundary.</p></dd>

  <dt>u</dt>
<dd><p>Upper boundary.</p></dd>

  <dt>n</dt>
<dd><p>Sample size on control in stage 1.</p></dd>

  <dt>N</dt>
<dd><p>Maximum total sample size.</p></dd>

  <dt>K</dt>
<dd><p>Number of experimental treatments.</p></dd>

  <dt>J</dt>
<dd><p>Number of stages in the trial.</p></dd>

  <dt>alpha</dt>
<dd><p>Familywise error rate.</p></dd>

  <dt>alpha.star</dt>
<dd><p>Cumulative familywise error rate spent by each analysis.</p></dd>

  <dt>power</dt>
<dd><p>Power under least favorable configuration.</p></dd>

  <dt>rMat</dt>
<dd><p>Matrix of allocation ratios. First row corresponds to control while subsequent rows are for the experimental treatments.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="generic.html">print.MAMS</a></code>, <code><a href="generic.html">summary.MAMS</a></code>, <code><a href="generic.html">plot.MAMS</a></code>, <code><a href="new.bounds.html">new.bounds</a></code>, <code><a href="ordinal.mams.html">ordinal.mams</a></code>, <code><a href="tite.mams.html">tite.mams</a></code>, <code><a href="MAMS-package.html">MAMS</a></code>.</p></div>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Jaki T., Pallmann P. and Magirr D. (2019), <em>The R Package MAMS for Designing Multi-Arm Multi-Stage Clinical Trials</em>, <b>Journal of Statistical Software</b>, 88(4), 1-25. Link: <a href="https://doi.org/10.18637/jss.v088.i04" class="external-link">doi:10.18637/jss.v088.i04</a></p>
<p>Magirr D., Jaki T. and Whitehead J. (2012), <em>A generalized Dunnett test for multi-arm multi-stage clinical studies with treatment selection</em>, <b>Biometrika</b>, 99(2), 494-501. Link: <a href="https://doi.org/10.1093/biomet/ass002" class="external-link">doi:10.1093/biomet/ass002</a></p>
<p>Pocock S.J. (1977), <em>Group sequential methods in the design and analysis of clinical trials</em>, <b>Biometrika</b>, 64(2), 191-199.<br></p>
<p>O'Brien P.C., Fleming T.R. (1979), <em>A multiple testing procedure for clinical trials</em>, <b>Biometrics</b>, 35(3), 549-556.<br></p>
<p>Whitehead J. (1997), <em>The Design and Analysis of Sequential Clinical Trials</em>, <b>Wiley</b>: Chichester, UK.<br></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Thomas Jaki, Dominic Magirr and Dominique-Laurent Couturier</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">## A fixed sample (single stage) design specified on the p scale</span></span></span>
<span class="r-in"><span><span class="fu">mams</span><span class="op">(</span>K<span class="op">=</span><span class="fl">4</span>, J<span class="op">=</span><span class="fl">1</span>, alpha<span class="op">=</span><span class="fl">0.05</span>, power<span class="op">=</span><span class="fl">0.9</span>, r<span class="op">=</span><span class="fl">1</span>, r0<span class="op">=</span><span class="fl">1</span>, p<span class="op">=</span><span class="fl">0.65</span>, p0<span class="op">=</span><span class="fl">0.55</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    i) find lower and upper boundaries</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   ii) define alpha star</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  iii) perform sample size calculation</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       (maximum iteration number = 252)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 50</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design parameters for a 1 stage trial with 4 treatments</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                             Stage 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (control):      84</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (active):       84</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum total sample size:  420 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Stage 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper bound:    2.16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower bound:    2.16</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The same design specified on the delta scale</span></span></span>
<span class="r-in"><span><span class="fu">mams</span><span class="op">(</span>K<span class="op">=</span><span class="fl">4</span>, J<span class="op">=</span><span class="fl">1</span>, alpha<span class="op">=</span><span class="fl">0.05</span>, power<span class="op">=</span><span class="fl">0.9</span>, r<span class="op">=</span><span class="fl">1</span>, r0<span class="op">=</span><span class="fl">1</span>, p<span class="op">=</span><span class="cn">NULL</span>, p0<span class="op">=</span><span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>     delta<span class="op">=</span><span class="fl">0.545</span>, delta0<span class="op">=</span><span class="fl">0.178</span>, sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    i) find lower and upper boundaries</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   ii) define alpha star</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  iii) perform sample size calculation</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       (maximum iteration number = 252)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 50</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design parameters for a 1 stage trial with 4 treatments</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                             Stage 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (control):      84</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (active):       84</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum total sample size:  420 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Stage 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper bound:    2.16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower bound:    2.16</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## An example in Table 1 of Magirr et al (2012)</span></span></span>
<span class="r-in"><span><span class="co"># 2-stage design with O'Brien &amp; Fleming efficacy and zero futility boundary</span></span></span>
<span class="r-in"><span><span class="fu">mams</span><span class="op">(</span>K<span class="op">=</span><span class="fl">4</span>, J<span class="op">=</span><span class="fl">2</span>, alpha<span class="op">=</span><span class="fl">0.05</span>, power<span class="op">=</span><span class="fl">0.9</span>, r<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, r0<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, p<span class="op">=</span><span class="fl">0.65</span>, p0<span class="op">=</span><span class="fl">0.55</span>, </span></span>
<span class="r-in"><span>     ushape<span class="op">=</span><span class="st">"obf"</span>, lshape<span class="op">=</span><span class="st">"fixed"</span>, lfix<span class="op">=</span><span class="fl">0</span>, nstart<span class="op">=</span><span class="fl">40</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    i) find lower and upper boundaries</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   ii) define alpha star</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  iii) perform sample size calculation</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       (maximum iteration number = 348)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design parameters for a 2 stage trial with 4 treatments</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                             Stage 1 Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (control):      44      88</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (active):       44      88</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum total sample size:  440 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Stage 1 Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper bound:   3.068   2.169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower bound:   0.000   2.169</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note that these examples may take a few minutes to run</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## 3-stage design with Triangular efficacy and futility boundary</span></span></span>
<span class="r-in"><span><span class="fu">mams</span><span class="op">(</span>K<span class="op">=</span><span class="fl">4</span>, J<span class="op">=</span><span class="fl">3</span>, alpha<span class="op">=</span><span class="fl">0.05</span>, power<span class="op">=</span><span class="fl">0.9</span>, r<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, r0<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, p<span class="op">=</span><span class="fl">0.65</span>, p0<span class="op">=</span><span class="fl">0.55</span>, </span></span>
<span class="r-in"><span>     ushape<span class="op">=</span><span class="st">"triangular"</span>, lshape<span class="op">=</span><span class="st">"triangular"</span>, nstart<span class="op">=</span><span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    i) find lower and upper boundaries</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   ii) define alpha star</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  iii) perform sample size calculation</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       (maximum iteration number = 298)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design parameters for a 3 stage trial with 4 treatments</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                             Stage 1 Stage 2 Stage 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (control):      36      72     108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (active):       36      72     108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum total sample size:  540 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Stage 1 Stage 2 Stage 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper bound:   2.706   2.392   2.344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower bound:   0.000   1.435   2.344</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example of a custom boundary function without sample size evaluation</span></span></span>
<span class="r-in"><span><span class="fu">mams</span><span class="op">(</span>K<span class="op">=</span><span class="fl">6</span>, J<span class="op">=</span><span class="fl">3</span>, alpha<span class="op">=</span><span class="fl">0.05</span>, power<span class="op">=</span><span class="fl">0.9</span>, r<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, r0<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, p<span class="op">=</span><span class="fl">0.7</span>, p0<span class="op">=</span><span class="fl">0.5</span>, </span></span>
<span class="r-in"><span>     ushape<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>, lshape<span class="op">=</span><span class="st">"fixed"</span>, lfix<span class="op">=</span><span class="fl">0</span>, </span></span>
<span class="r-in"><span>     sample.size<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    i) find lower and upper boundaries</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   ii) define alpha star</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design parameters for a 3 stage trial with 6 treatments</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Stage 1 Stage 2 Stage 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper bound:   6.834   4.556   2.278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower bound:   0.000   0.000   2.278</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Different allocation ratios between control and experimental treatments. </span></span></span>
<span class="r-in"><span><span class="co">## Twice as many patients are randomized to control at each stage.</span></span></span>
<span class="r-in"><span><span class="fu">mams</span><span class="op">(</span>K<span class="op">=</span><span class="fl">4</span>, J<span class="op">=</span><span class="fl">2</span>, alpha<span class="op">=</span><span class="fl">0.05</span>, power<span class="op">=</span><span class="fl">0.9</span>, r<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, r0<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>, p<span class="op">=</span><span class="fl">0.65</span>, p0<span class="op">=</span><span class="fl">0.55</span>, </span></span>
<span class="r-in"><span>     ushape<span class="op">=</span><span class="st">"obf"</span>, lshape<span class="op">=</span><span class="st">"fixed"</span>, lfix<span class="op">=</span><span class="fl">0</span>, nstart<span class="op">=</span><span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    i) find lower and upper boundaries</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   ii) define alpha star</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  iii) perform sample size calculation</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       (maximum iteration number = 271)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design parameters for a 2 stage trial with 4 treatments</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                             Stage 1 Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (control):      70     140</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (active):       35      70</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum total sample size:  420 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Stage 1 Stage 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper bound:    3.12   2.206</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower bound:    0.00   2.206</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## </span></span></span>
<span class="r-in"><span><span class="co">## example considering different parallelisation strategies </span></span></span>
<span class="r-in"><span><span class="co">## </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># parallel = FALSE (future framework not used)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">mams</span><span class="op">(</span>K<span class="op">=</span><span class="fl">4</span>, J<span class="op">=</span><span class="fl">3</span>, alpha<span class="op">=</span><span class="fl">0.05</span>, power<span class="op">=</span><span class="fl">0.9</span>, r<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, r0<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, p<span class="op">=</span><span class="fl">0.65</span>, p0<span class="op">=</span><span class="fl">0.55</span>, </span></span>
<span class="r-in"><span>     ushape<span class="op">=</span><span class="st">"triangular"</span>, lshape<span class="op">=</span><span class="st">"triangular"</span>, nstart<span class="op">=</span><span class="fl">30</span>, parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    i) find lower and upper boundaries</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   ii) define alpha star</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  iii) perform sample size calculation</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       (maximum iteration number = 298)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design parameters for a 3 stage trial with 4 treatments</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                             Stage 1 Stage 2 Stage 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (control):      36      72     108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (active):       36      72     108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum total sample size:  540 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Stage 1 Stage 2 Stage 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper bound:   2.706   2.392   2.344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower bound:   0.000   1.435   2.344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   50.04    0.28  117.91 </span>
<span class="r-in"><span><span class="co"># parallel = TRUE (default) with default strategy (sequential computation)</span></span></span>
<span class="r-in"><span><span class="fu">plan</span><span class="op">(</span><span class="va">sequential</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">mams</span><span class="op">(</span>K<span class="op">=</span><span class="fl">4</span>, J<span class="op">=</span><span class="fl">3</span>, alpha<span class="op">=</span><span class="fl">0.05</span>, power<span class="op">=</span><span class="fl">0.9</span>, r<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, r0<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, p<span class="op">=</span><span class="fl">0.65</span>, p0<span class="op">=</span><span class="fl">0.55</span>, </span></span>
<span class="r-in"><span>     ushape<span class="op">=</span><span class="st">"triangular"</span>, lshape<span class="op">=</span><span class="st">"triangular"</span>, nstart<span class="op">=</span><span class="fl">30</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    i) find lower and upper boundaries</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   ii) define alpha star</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  iii) perform sample size calculation</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       (maximum iteration number = 298)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design parameters for a 3 stage trial with 4 treatments</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                             Stage 1 Stage 2 Stage 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (control):      36      72     108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (active):       36      72     108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum total sample size:  540 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Stage 1 Stage 2 Stage 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper bound:   2.706   2.392   2.344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower bound:   0.000   1.435   2.344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   14.08    0.06   71.95 </span>
<span class="r-in"><span><span class="co"># parallel = TRUE(default) with multisession strategy (parallel computation)</span></span></span>
<span class="r-in"><span><span class="fu">plan</span><span class="op">(</span><span class="va">multisession</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">mams</span><span class="op">(</span>K<span class="op">=</span><span class="fl">4</span>, J<span class="op">=</span><span class="fl">3</span>, alpha<span class="op">=</span><span class="fl">0.05</span>, power<span class="op">=</span><span class="fl">0.9</span>, r<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, r0<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, p<span class="op">=</span><span class="fl">0.65</span>, p0<span class="op">=</span><span class="fl">0.55</span>, </span></span>
<span class="r-in"><span>     ushape<span class="op">=</span><span class="st">"triangular"</span>, lshape<span class="op">=</span><span class="st">"triangular"</span>, nstart<span class="op">=</span><span class="fl">30</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    i) find lower and upper boundaries</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   ii) define alpha star</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  iii) perform sample size calculation</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       (maximum iteration number = 298)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design parameters for a 3 stage trial with 4 treatments</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                             Stage 1 Stage 2 Stage 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (control):      36      72     108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative sample size per stage (active):       36      72     108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum total sample size:  540 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Stage 1 Stage 2 Stage 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper bound:   2.706   2.392   2.344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower bound:   0.000   1.435   2.344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   16.86    0.41   50.73 </span>
<span class="r-in"><span><span class="fu">plan</span><span class="op">(</span><span class="st">"default"</span><span class="op">)</span>       </span></span>
<span class="r-in"><span>     </span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Thomas Jaki, Dominique-Laurent Couturier, Dominic Magirr, Nikita Mozgunov, Philip Pallmann.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

