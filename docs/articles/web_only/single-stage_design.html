<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="MAMS">
<title>Single-stage design • MAMS</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="Single-stage design">
<meta property="og:description" content="MAMS">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../../index.html">MAMS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tutorials">Tutorials</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tutorials">
    <h6 class="dropdown-header" data-toc-skip>Basics</h6>
    <a class="dropdown-item" href="../../articles/web_only/reproducibility.html">Reproducibility</a>
    <a class="dropdown-item" href="../../articles/web_only/parallelisation.html">Parallelisation</a>
    <h6 class="dropdown-header" data-toc-skip>Design studies</h6>
    <a class="dropdown-item" href="../../articles/web_only/single-stage_design.html">Single stage design</a>
    <a class="dropdown-item" href="../../articles/web_only/multi-stage_design.html">Multi-stage design</a>
    <a class="dropdown-item" href="../../articles/web_only/evaluating_properties.html">Desing operating charachteristics</a>
    <a class="dropdown-item" href="../../articles/web_only/step-down_design.html">A step-down design</a>
    <a class="dropdown-item" href="../../articles/web_only/unforeseen_design_modifications.html">Unforeseen design modifications</a>
    <a class="dropdown-item" href="../../articles/web_only/non-normal_endpoints.html">Non-normal endpoints</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../../logo.png" class="logo" alt=""><h1>Single-stage design</h1>
            
      
      
      <div class="d-none name"><code>single-stage_design.Rmd</code></div>
    </div>

    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.23.4/ace.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.23.4/mode-r.min.js"></script><script type="module">
  import { WebR } from 'https://webr.r-wasm.org/latest/webr.mjs';
  
  // Initialize shared WebR environment
  async function initWebR() {
    const webR = new WebR();
    await webR.init();
    await webR.evalRVoid(`{webr::install('MAMS')}`);
    await webR.evalRVoid(`{library(MAMS)}`);
    await webR.evalRVoid('options(device=function(...){webr::canvas(width=500, height=300)})');
    return webR;
  }

  const webRPromise = initWebR(); // This promise will resolve with the initialized WebR object

  // Define a shared shelter object
  let shelter;

  // Initialize editors
  var editor = ace.edit("editor");
  editor.setOptions({ fontSize: "11pt", maxLines: Infinity });
  editor.session.setMode("ace/mode/r");
  editor.setShowPrintMargin(true);
  var currentContent = editor.getValue();
  editor.setValue(currentContent.trim(), -1); // -1 sets the cursor at the start
  
  var editor2 = ace.edit("editor2");
  editor2.setOptions({ fontSize: "11pt", maxLines: Infinity });
  editor2.session.setMode("ace/mode/r");
  var currentContent = editor2.getValue();
  editor2.setValue(currentContent.trim(), -1); // -1 sets the cursor at the start
  
  var editor3 = ace.edit("editor3");
  editor3.setOptions({ fontSize: "11pt", maxLines: Infinity });
  editor3.session.setMode("ace/mode/r");
  var currentContent = editor3.getValue();
  editor3.setValue(currentContent.trim(), -1); // -1 sets the cursor at the start
  
  var editor4 = ace.edit("editor4");
  editor4.setOptions({ fontSize: "11pt", maxLines: Infinity });
  editor4.session.setMode("ace/mode/r");
  var currentContent = editor4.getValue();
  editor4.setValue(currentContent.trim(), -1); // -1 sets the cursor at the start
  
  var editor5 = ace.edit("editor5");
  editor5.setOptions({ fontSize: "11pt", maxLines: Infinity });
  editor5.session.setMode("ace/mode/r");
  var currentContent = editor5.getValue();
  editor5.setValue(currentContent.trim(), -1); // -1 sets the cursor at the start
  
  // Common function to run R code from either editor
  async function runR(editorId, outputId) {
    const webR = await webRPromise; // Ensure WebR is initialized
    if (!shelter) {
      shelter = await new webR.Shelter();
    }

    document.getElementById('canvas').style.display = 'none';
    let code = ace.edit(editorId).getValue();
    const result = await shelter.captureR(code, {
      withAutoprint: true,
      captureStreams: true,
      captureConditions: false
    });

    try {
      const out = result.output.filter(
        evt => evt.type == 'stdout' || evt.type == 'stderr'
      ).map((evt) => evt.data);
      document.getElementById(outputId).innerText = out.join('\n');
    } finally {
      shelter.purge();
    }
  }

  // Attach the run functions to buttons
  document.getElementById('runButton').onclick = () => runR('editor', 'out');
  document.getElementById('runButton2').onclick = () => runR('editor2', 'out2');
  document.getElementById('runButton3').onclick = () => runR('editor3', 'out3');
  document.getElementById('runButton4').onclick = () => runR('editor4', 'out4');
  document.getElementById('runButton5').onclick = () => runR('editor5', 'out5');

  // Enable buttons after WebR is initialized
  webRPromise.then(() => {
    document.getElementById('runButton').disabled = false;
    document.getElementById('runButton').innerText = 'Run code';
    document.getElementById('runButton2').disabled = false;
    document.getElementById('runButton2').innerText = 'Run code';
    document.getElementById('runButton3').disabled = false;
    document.getElementById('runButton3').innerText = 'Run code';
    document.getElementById('runButton4').disabled = false;
    document.getElementById('runButton4').innerText = 'Run code';
    document.getElementById('runButton5').disabled = false;
    document.getElementById('runButton5').innerText = 'Run code';
  });
</script><p>In this vignette we showcase some uses of the <strong>MAMS</strong>
package and how to interpret the corresponding R output.</p>
<div class="section level3">
<h3 id="tailor-study">TAILoR Study<a class="anchor" aria-label="anchor" href="#tailor-study"></a>
</h3>
<p>The TAILoR study <span class="citation">(<a href="#ref-pushpakom2015">Pushpakom et al. 2015</a>)</span> serves as
the motivating example, and so we consider a design that evaluates three
different experimental treatment arms against control, using a one-sided
type I error rate of 5% and 90% power. The interesting effect size is
set to <span class="math inline">\(\mathrm{p} = 0.65\)</span>, which
corresponds to an effect of <span class="math inline">\(δ =
0.545σ\)</span> on the traditional scale. The uninteresting treatment
effect is chosen as <span class="math inline">\(\mathrm{p}_0 =
0.55\)</span> (<span class="math inline">\(δ_0 = 0.178σ\)</span>).
<strong>MAMS</strong> allows the user to choose whichever
parameterization they prefer for specifying the effect sizes.</p>
</div>
<div class="section level3">
<h3 id="mams-function">
<code>mams()</code> function<a class="anchor" aria-label="anchor" href="#mams-function"></a>
</h3>
<p>Designing studies including finding the boundaries of the design and
the required sample size can be achieved with the function
<code>mams</code>. The parameters of the function correspond to the
definition in Section 2 <span class="citation">(<a href="#ref-jaki2019">Jaki, Pallmann, and Magirr 2019</a>)</span> so that
<code>K</code>, e.g., specifies the number of experimental treatments
that are to be compared to control, and <code>J</code> the number of
stages. We begin by considering a single-stage design
(<code>J = 1</code>), which corresponds to a design based on a standard
Dunnett test <span class="citation">(<a href="#ref-dunnett1955">Dunnett
1955</a>)</span> involving <code>K = 3</code> experimental treatments.
We use equal allocation between treatment arms, which is specified via
<code>r=1</code> for the experimental arms and <code>r0=1</code> for
control.</p>
<button class="btn btn-success btn-sm" disabled type="button" id="runButton">
Loading webR…
</button>
<div id="editor">
<p>library(MAMS)<br>
set.seed(2910)<br>
m1 &lt;- mams(K = 3, J = 1, p = 0.65, p0 = 0.55, r = 1, r0 = 1, alpha =
0.05, power = 0.9)</p>
</div>
<pre><code id="out"></code></pre>
<canvas id="canvas" width="1000" height="600" style="display: none; margin: auto; width: 700px;"></canvas><p>An overview of the design is displayed with <code>print(m1)</code> or
<code>summary(m1)</code> or simply <code>m1</code>.</p>
<button class="btn btn-success btn-sm" disabled type="button" id="runButton2">
Loading webR...
</button>
<div id="editor2">
<p>m1</p>
</div>
<pre><code id="out2"></code></pre>
<canvas id="canvas" width="1000" height="600" style="display: none; margin: auto; width: 700px;"></canvas><p>The output produced specifies the number of patients required on
control and each treatment arm as well as the boundaries of the design.
A total of 316 patients, 79 on control and 79 on each of the 3
experimental treatments, are required for this study. The null
hypothesis for treatment k can be rejected if the corresponding test
statistic is larger than 2.062. The same design can also be specified on
the scale of traditional effect sizes rather than probabilities, by
setting <code>p</code> and <code>p0</code> to <code>NULL</code> and
specifying values for <code>delta</code>, <code>delta0</code>, and
<code>sd</code>. The output will be exactly the same as for
<code>m1</code>.</p>
<button class="btn btn-success btn-sm" disabled type="button" id="runButton3">
Loading webR...
</button>
<div id="editor3">
<p>m1d &lt;- mams(K = 3, J = 1, p = NULL, p0 = NULL, delta = 0.545,
delta0 = 0.178, sd = 1, r = 1, r0 = 1, alpha = 0.05, power = 0.9)</p>
<p>m1d</p>
</div>
<pre><code id="out3"></code></pre>
<canvas id="canvas" width="1000" height="600" style="display: none; margin: auto; width: 700px;"></canvas><p>In the remainder of this section we will specify all effect sizes on
the probability scale, but converting them is straightforward in R:</p>
<button class="btn btn-success btn-sm" disabled type="button" id="runButton4">
Loading webR...
</button>
<div id="editor4">
<p>pnorm(0.545 / sqrt(2))</p>
</div>
<pre><code id="out4"></code></pre>
<canvas id="canvas" width="1000" height="600" style="display: none; margin: auto; width: 700px;"></canvas><button class="btn btn-success btn-sm" disabled type="button" id="runButton5">
Loading webR...
</button>
<div id="editor5">
<p>qnorm(0.65) * sqrt(2)</p>
</div>
<pre><code id="out5"></code></pre>
<canvas id="canvas" width="1000" height="600" style="display: none; margin: auto; width: 700px;"></canvas>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-dunnett1955" class="csl-entry">
Dunnett, Charles W. 1955. <span>“A Multiple Comparison Procedure for
Comparing Several Treatments with a Control.”</span> <em>Journal of the
American Statistical Association</em> 50 (272): 1096–1121. <a href="https://doi.org/10.1080/01621459.1955.10501294" class="external-link">https://doi.org/10.1080/01621459.1955.10501294</a>.
</div>
<div id="ref-jaki2019" class="csl-entry">
Jaki, Thomas, Philip Pallmann, and Dominic Magirr. 2019. <span>“The
<span><em>R</em></span> Package <span><strong>MAMS</strong></span> for
Designing Multi-Arm Multi-Stage Clinical Trials.”</span> <em>Journal of
Statistical Software</em> 88 (4). <a href="https://doi.org/10.18637/jss.v088.i04" class="external-link">https://doi.org/10.18637/jss.v088.i04</a>.
</div>
<div id="ref-pushpakom2015" class="csl-entry">
Pushpakom, Sudeep P, Claire Taylor, Ruwanthi Kolamunnage-Dona, Catherine
Spowart, Jiten Vora, Marta García-Fiñana, Graham J Kemp, et al. 2015.
<span>“Telmisartan and Insulin Resistance in HIV (TAILoR): Protocol for
a Dose-Ranging Phase II Randomised Open-Labelled Trial of Telmisartan as
a Strategy for the Reduction of Insulin Resistance in HIV-Positive
Individuals on Combination Antiretroviral Therapy.”</span> <em>BMJ
Open</em> 5 (10): e009566. <a href="https://doi.org/10.1136/bmjopen-2015-009566" class="external-link">https://doi.org/10.1136/bmjopen-2015-009566</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Thomas Jaki, Dominique-Laurent Couturier, Dominic Magirr, Nikita Mozgunov, Philip Pallmann.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
