<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="MAMS">
<title>A step-down design • MAMS</title>
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="A step-down design">
<meta property="og:description" content="MAMS">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../../index.html">MAMS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tutorials">Tutorials</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tutorials">
    <h6 class="dropdown-header" data-toc-skip>Basics</h6>
    <a class="dropdown-item" href="../../articles/web_only/reproducibility.html">Reproducibility</a>
    <a class="dropdown-item" href="../../articles/web_only/parallelisation.html">Parallelisation</a>
    <h6 class="dropdown-header" data-toc-skip>Design studies</h6>
    <a class="dropdown-item" href="../../articles/web_only/single-stage_design.html">Single stage design</a>
    <a class="dropdown-item" href="../../articles/web_only/multi-stage_design.html">Multi-stage design</a>
    <a class="dropdown-item" href="../../articles/web_only/evaluating_properties.html">Desing operating charachteristics</a>
    <a class="dropdown-item" href="../../articles/web_only/step-down_design.html">A step-down design</a>
    <a class="dropdown-item" href="../../articles/web_only/unforeseen_design_modifications.html">Unforeseen design modifications</a>
    <a class="dropdown-item" href="../../articles/web_only/non-normal_endpoints.html">Non-normal endpoints</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>A step-down design</h1>
            
      
      
      <div class="d-none name"><code>step-down_design.Rmd</code></div>
    </div>

    
    
<p>A direct improvement over the basic design can be achieved by using a
step-down version of the test. The function stepdown.mams implements
such a design that selects at interim either all promising treatments
<code>(selection = "all.promising")</code> or only the best performing
treatment <code>(selection = "select.best")</code> from those whose test
statistics are between the upper and lower boundaries <span class="citation">(<a href="#ref-stallard2003">Stallard and Todd
2003</a>)</span>. If the trial is stopped early, making a selection
becomes obsolete, but note that we consider stopping boundaries as
non-binding. The step-down procedure makes use of closed testing, as
described in Section 2.2 <span class="citation">(<a href="#ref-jaki2019">Jaki, Pallmann, and Magirr 2019</a>)</span> and
<span class="citation">(<a href="#ref-magirr2014">Magirr, Stallard, and
Jaki 2014</a>)</span>.<br></p>
<p>We reuse the three-arm two-stage design <code>m2</code> with 76 and
38 observations in stage 1 and cumulative sample sizes at stage two of
152 and 76 on control and active treatments, respectively. The sample
size of the study can be specified through the matrix <span class="math inline">\(nMat\)</span> that has <span class="math inline">\(J\)</span> rows and <span class="math inline">\(K\)</span> columns where the first column contains
the values for the control group. A lower boundary can be set via <span class="math inline">\(lb\)</span>, and we set it to <span class="math inline">\(0.786\)</span> as in the original design. We can
then choose how much of the total family-wise error we want to spend at
each stage using the argument <span class="math inline">\(alpha.star\)</span>, and we choose to spend, in
line with the triangular test, <span class="math inline">\(\alpha^*_1 =
0.026\)</span> $ at the first interim analysis, with the remaining <span class="math inline">\(α\)</span> level being used at the second
analysis. We compare the selection rules <span class="math inline">\(all.promising\)</span> and <span class="math inline">\(select.best\)</span>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m2.all</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/stepdown.mams.html">stepdown.mams</a></span><span class="op">(</span>nMat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">76</span>, <span class="fl">152</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">38</span>, <span class="fl">76</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span> nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>, lb <span class="op">=</span> <span class="va">m2</span><span class="op">$</span><span class="va">l</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, alpha.star <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.026</span>, <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>selection <span class="op">=</span> <span class="st">"all.promising"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m2.best</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/stepdown.mams.html">stepdown.mams</a></span><span class="op">(</span>nMat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">76</span>, <span class="fl">152</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">38</span>, <span class="fl">76</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>, lb <span class="op">=</span> <span class="va">m2</span><span class="op">$</span><span class="va">l</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, alpha.star <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.026</span>, <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>selection <span class="op">=</span> <span class="st">"select.best"</span><span class="op">)</span></span></code></pre></div>
<p>The output for all intersections and stages is verbose, therefore we
summarizes only the upper boundary values in Table.</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="41%">
<col width="13%">
<col width="23%">
<col width="22%">
</colgroup>
<thead><tr class="header">
<th>Hypotheses</th>
<th align="center">Stage 1</th>
<th align="center">Stage 2 (best)</th>
<th align="center">Stage 2 (all)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>
<span class="math inline">\(H_1\)</span>,<span class="math inline">\(H_2\)</span>,<span class="math inline">\(H_3\)</span>
</td>
<td align="center">1.94</td>
<td align="center">1.71</td>
<td align="center">1.72</td>
</tr>
<tr class="even">
<td>
<span class="math inline">\(H_{12}\)</span>,<span class="math inline">\(H_{13}\)</span>,<span class="math inline">\(H_{23}\)</span>
</td>
<td align="center">2.21</td>
<td align="center">2.02</td>
<td align="center">2.06</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(H_{123}\)</span></td>
<td align="center">2.36</td>
<td align="center">2.17</td>
<td align="center">2.22</td>
</tr>
</tbody>
</table>
<p>Upper boundaries for the elementary (H1, H2, H3), intersection (H12,
H13, H23), and global (H123) hypotheses of a three-arm two-stage
step-down design involving selection of either the single best or all
promising treatments at interim.</p>
<p>One can see that the option to proceed with more than one promising
treatment comes at the cost of higher stopping boundaries for the
intersection hypotheses at stage 2. So in order to reject the global
null hypothesis at the second stage, a test statistic needs to exceed
2.22 while it only needs to be larger than 2.17 if only the best arm is
chosen at the interim analysis. The boundaries are the same for the
elementary hypotheses H1, H2, and H3 as well as for the intersection
hypotheses H12, H13, and H23 because the sample sizes were chosen to be
equal in all active treatment arms. A graphical display of the stopping
boundaries using the plot function is shown in Figure.</p>
<p><img src="step-down_design_plot.png"><br>
Figure: Stopping boundaries for a three-arm two-stage step-down design
with selection of all promising treatments at interim (left) or just the
single best treatment (right).</p>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-jaki2019" class="csl-entry">
Jaki, Thomas, Philip Pallmann, and Dominic Magirr. 2019. <span>“The
<span><em>R</em></span> Package <span><strong>MAMS</strong></span> for
Designing Multi-Arm Multi-Stage Clinical Trials.”</span> <em>Journal of
Statistical Software</em> 88 (4). <a href="https://doi.org/10.18637/jss.v088.i04" class="external-link">https://doi.org/10.18637/jss.v088.i04</a>.
</div>
<div id="ref-magirr2014" class="csl-entry">
Magirr, D., N. Stallard, and T. Jaki. 2014. <span>“Flexible Sequential
Designs for Multi<span>-</span>Arm Clinical Trials.”</span>
<em>Statistics in Medicine</em> 33 (19): 3269–79. <a href="https://doi.org/10.1002/sim.6183" class="external-link">https://doi.org/10.1002/sim.6183</a>.
</div>
<div id="ref-stallard2003" class="csl-entry">
Stallard, Nigel, and Susan Todd. 2003. <span>“Sequential Designs for
Phase III Clinical Trials Incorporating Treatment Selection.”</span>
<em>Statistics in Medicine</em> 22 (5): 689–703. <a href="https://doi.org/10.1002/sim.1362" class="external-link">https://doi.org/10.1002/sim.1362</a>.
</div>
</div>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Thomas Jaki, Dominique-Laurent Couturier, Dominic Magirr, Philip Pallmann.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
